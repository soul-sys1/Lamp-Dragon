"""
–ú–û–î–ï–õ–¨ –î–†–ê–ö–û–ù–ê v6.0
–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏–∫—É –¥—Ä–∞–∫–æ–Ω–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è –Ω–∞ 5% –≤ —á–∞—Å (–≤–º–µ—Å—Ç–æ 10%)
10 –≥–ª—É–±–æ–∫–æ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–≤
"""
import random
from datetime import datetime, timedelta
import json
from typing import Dict, List, Optional, Tuple

class Dragon:
    def __init__(self, name="–î—Ä–∞–∫–æ—à–∞"):
        self.name = name
        self.created_at = datetime.now().isoformat()
        
        # –û–°–ù–û–í–ù–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò (0-100, –≤—Å–µ–≥–¥–∞ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
        # –£–í–ï–õ–ò–ß–ò–õ–ò –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–≥–æ –≥–µ–π–º–ø–ª–µ—è
        self.stats = {
            "–∫–æ—Ñ–µ": 50,          # –•–æ—á–µ—Ç –∫–æ—Ñ–µ (–±—ã–ª–æ 70)
            "—Å–æ–Ω": 50,           # –•–æ—á–µ—Ç —Å–ø–∞—Ç—å (–±—ã–ª–æ 30)
            "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 90,    # –û–±—â–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (–±—ã–ª–æ 80)
            "–∞–ø–ø–µ—Ç–∏—Ç": 50,       # –ì–æ–ª–æ–¥ (–±—ã–ª–æ 60)
            "—ç–Ω–µ—Ä–≥–∏—è": 80,       # –≠–Ω–µ—Ä–≥–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π (–±—ã–ª–æ 75)
            "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 95,    # –£—Ö–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —à–µ—Ä—Å—Ç–∏ (–±—ã–ª–æ 90)
            "—á–∏—Å—Ç–æ—Ç–∞": 90,       # –û–±—â–∞—è —á–∏—Å—Ç–æ—Ç–∞ (–±—ã–ª–æ 85)
            "–∑–¥–æ—Ä–æ–≤—å–µ": 95       # –û–±—â–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ (–±—ã–ª–æ 95)
        }
        
        # –ù–ê–í–´–ö–ò –î–†–ê–ö–û–ù–ê (0-100, –≤—Å–µ–≥–¥–∞ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
        self.skills = {
            "–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ": 10,      # –ù–∞–≤—ã–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è/–ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ—Ñ–µ
            "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å": 5,         # –õ—é–±–æ–≤—å –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–Ω–∏–≥
            "–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è": 5,          # –ù–∞–≤—ã–∫ –≤ –∏–≥—Ä–∞—Ö
            "–≤—è–∑–∞–ª—å–Ω–∞—è_—Å–Ω–æ—Ä–æ–≤–∫–∞": 0,        # –ù–∞–≤—ã–∫ —Ä—É–∫–æ–¥–µ–ª–∏—è
            "–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ": 0,      # –ù–∞–≤—ã–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –µ–¥—ã
            "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö": 0,          # –ß—É–≤—Å—Ç–≤–æ —Ä–∏—Ç–º–∞ –∏ –º—É–∑—ã–∫–∏
            "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º": 0,                  # –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            "–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å": 0,              # –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞
            "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 5,                 # –£–º—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è": 5               # –ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
        }
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä (10 —Ç–∏–ø–æ–≤)
        self.character = self._generate_character()
        
        # –ü–†–û–ì–†–ï–°–° –ò –≠–ö–û–ù–û–ú–ò–ö–ê
        self.level = 1
        self.experience = 0
        self.gold = 50
        
        # –ò–ù–í–ï–ù–¢–ê–†–¨ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –±–∞–∑–æ–π)
        self.inventory = {}
        
        # –ü–†–ò–í–´–ß–ö–ò
        self.habits = []
        
        # –õ–Æ–ë–ò–ú–´–ï –í–ï–©–ò (–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º)
        self.favorites = self._generate_favorites()
        
        # –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ï–ô–°–¢–í–ò–ô
        self.action_stats = {
            "total_coffees": 0,
            "total_feeds": 0,
            "total_hugs": 0,
            "total_games": 0,
            "total_care": 0,
            "total_sleep": 0,
            "total_minigames_won": 0,
            "total_minigames_lost": 0
        }
        
        # –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
        self.achievements = []
        
        # –ü–û–°–õ–ï–î–ù–ò–ï –î–ï–ô–°–¢–í–ò–Ø (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
        self.last_actions = {
            "coffee": None,
            "feed": None,
            "hug": None,
            "game": None,
            "care": None,
            "sleep": None
        }
        
        # –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        self.last_update = datetime.now().isoformat()
        
        # –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –§–õ–ê–ì–ò
        self.special_effects = {
            "coffee_art_unlocked": False,
            "massage_unlocked": False,
            "bath_unlocked": False,
            "toy_enjoyment": 0  # –ù–∞—Å–∫–æ–ª—å–∫–æ –¥—Ä–∞–∫–æ–Ω—É –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–≥—Ä—É—à–∫–∞
        }
        
        # –§–ª–∞–≥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        self._last_stats_update = datetime.now()
    
    def _generate_character(self) -> Dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –¥—Ä–∞–∫–æ–Ω–∞ (10 —Ç–∏–ø–æ–≤)"""
        traits = [
            "–∫–æ—Ñ–µ–º–∞–Ω",      # –û–±–æ–∂–∞–µ—Ç –∫–æ—Ñ–µ, —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Å–æ—Ä—Ç–∞—Ö
            "–∫–Ω–∏–≥–æ—á–µ–π",     # –ü—Ä–æ–≤–æ–¥–∏—Ç –¥–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º
            "–Ω–µ–∂–µ–Ω–∫–∞",      # –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ª–∞—Å–∫–∏ –∏ –≤–Ω–∏–º–∞–Ω–∏—è
            "—á–∏—Å—Ç—é–ª—è",      # –°–ª–µ–¥–∏—Ç –∑–∞ —á–∏—Å—Ç–æ—Ç–æ–π, –ª—é–±–∏—Ç —É—Ö–æ–¥
            "–≥—É—Ä–º–∞–Ω",       # –†–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ –µ–¥–µ –∏ –Ω–∞–ø–∏—Ç–∫–∞—Ö
            "–∏–≥—Ä–∏–∫",        # –û–±–æ–∂–∞–µ—Ç –∏–≥—Ä—ã –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è
            "—Å–æ–Ω—è",         # –õ—é–±–∏—Ç –ø–æ—Å–ø–∞—Ç—å, –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—ë—Ç
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä",  # –í—Å–µ–≥–¥–∞ –ø–æ–ª–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏, –∞–∫—Ç–∏–≤–µ–Ω
            "—Ñ–∏–ª–æ—Å–æ—Ñ",      # –õ—é–±–∏—Ç —Ä–∞–∑–º—ã—à–ª—è—Ç—å, —Å–ø–æ–∫–æ–π–Ω—ã–π
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å" # –õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π, –∏–∑—É—á–∞–µ—Ç –≤—Å—ë –≤–æ–∫—Ä—É–≥
        ]
        
        main_trait = random.choice(traits)
        
        # –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ —á–µ—Ä—Ç—ã
        trait_compatibility = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–≥—É—Ä–º–∞–Ω", "—Ñ–∏–ª–æ—Å–æ—Ñ", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["—Ñ–∏–ª–æ—Å–æ—Ñ", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", "—Å–æ–Ω—è"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["—Å–æ–Ω—è", "—á–∏—Å—Ç—é–ª—è", "–≥—É—Ä–º–∞–Ω"],
            "—á–∏—Å—Ç—é–ª—è": ["–Ω–µ–∂–µ–Ω–∫–∞", "–≥—É—Ä–º–∞–Ω", "—Ñ–∏–ª–æ—Å–æ—Ñ"],
            "–≥—É—Ä–º–∞–Ω": ["–∫–æ—Ñ–µ–º–∞–Ω", "—á–∏—Å—Ç—é–ª—è", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å"],
            "–∏–≥—Ä–∏–∫": ["—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", "–∫–æ—Ñ–µ–º–∞–Ω"],
            "—Å–æ–Ω—è": ["–Ω–µ–∂–µ–Ω–∫–∞", "—Ñ–∏–ª–æ—Å–æ—Ñ", "–∫–Ω–∏–≥–æ—á–µ–π"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–∏–≥—Ä–∏–∫", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", "–∫–æ—Ñ–µ–º–∞–Ω"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["–∫–Ω–∏–≥–æ—á–µ–π", "—Å–æ–Ω—è", "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–∫–æ—Ñ–µ–º–∞–Ω", "–∏–≥—Ä–∏–∫", "—Ñ–∏–ª–æ—Å–æ—Ñ"]
        }
        
        compatible_traits = trait_compatibility.get(main_trait, traits)
        other_traits = [t for t in compatible_traits if t != main_trait]
        secondary = random.sample(other_traits, min(2, len(other_traits)))
        
        return {
            "–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞": main_trait,
            "–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ": secondary,
            "–æ–ø–∏—Å–∞–Ω–∏–µ": self._get_trait_description(main_trait),
            "—Å–∏–ª—å–Ω—ã–µ_—Å—Ç–æ—Ä–æ–Ω—ã": self._get_trait_strengths(main_trait),
            "—Å–ª–∞–±—ã–µ_—Å—Ç–æ—Ä–æ–Ω—ã": self._get_trait_weaknesses(main_trait)
        }
    
    def _get_trait_description(self, trait: str) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        descriptions = {
            "–∫–æ—Ñ–µ–º–∞–Ω": "–†–æ–∂–¥—ë–Ω —Å—Ä–µ–¥–∏ –∫–æ—Ñ–µ–π–Ω—ã—Ö –ø–ª–∞–Ω—Ç–∞—Ü–∏–π –≤–æ–ª—à–µ–±–Ω—ã—Ö –≥–æ—Ä, —á—É–≤—Å—Ç–≤—É–µ—Ç –∫–æ—Ñ–µ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –º–∏–ª–∏! –ï–≥–æ –Ω–æ—Å –º–æ–∂–µ—Ç —É–ª–æ–≤–∏—Ç—å –∞—Ä–æ–º–∞—Ç —Å–≤–µ–∂–µ—Å–≤–∞—Ä–µ–Ω–Ω–æ–≥–æ —ç—Å–ø—Ä–µ—Å—Å–æ –∑–∞ —Ç—Ä–∏ –¥–æ–º–∞.",
            "–∫–Ω–∏–≥–æ—á–µ–π": "–í—ã—Ä–∞—â–µ–Ω –≤ –¥—Ä–µ–≤–Ω–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –¥—Ä–∞–∫–æ–Ω—å–µ–≥–æ –∑–Ω–∞–Ω–∏—è, –ø—Ä–æ—á–∏—Ç–∞–ª –±–æ–ª—å—à–µ –∫–Ω–∏–≥, —á–µ–º –∑–≤—ë–∑–¥ –Ω–∞ –Ω–µ–±–µ. –ö–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞ –¥–ª—è –Ω–µ–≥–æ - –Ω–æ–≤–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ.",
            "–Ω–µ–∂–µ–Ω–∫–∞": "–°–∞–º—ã–π –ª–∞—Å–∫–æ–≤—ã–π –¥—Ä–∞–∫–æ–Ω –≤–æ –≤—Å—ë–º –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–µ! –†–æ–∂–¥—ë–Ω–Ω—ã–π –∏–∑ –æ–±–ª–∞–∫–∞ –Ω–µ–∂–Ω–æ—Å—Ç–∏ –∏ –∑–∞–±–æ—Ç—ã, –æ–Ω –≤–µ—Ä–∏—Ç, —á—Ç–æ –º–∏—Ä –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –æ–±—ä—è—Ç–∏—è–º–∏.",
            "—á–∏—Å—Ç—é–ª—è": "–ë–ª–µ—Å—Ç–∏—Ç –∏ —Å–≤–µ—Ä–∫–∞–µ—Ç, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–º–∞–∑! –°–ª–µ–¥–∏—Ç –∑–∞ —á–∏—Å—Ç–æ—Ç–æ–π —Ç–∞–∫ —Ç—â–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ –¥–∞–∂–µ –ø—ã–ª–∏–Ω–∫–∏ –±–æ—è—Ç—Å—è –∫ –Ω–µ–º—É –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å—Å—è.",
            "–≥—É—Ä–º–∞–Ω": "–ù–∞—Å—Ç–æ—è—â–∏–π —Ü–µ–Ω–∏—Ç–µ–ª—å –∏–∑—ã—Å–∫–∞–Ω–Ω—ã—Ö –≤–∫—É—Å–æ–≤! –†–æ–¥–∏–ª—Å—è –Ω–∞ –∫—É—Ö–Ω–µ –≤–æ–ª—à–µ–±–Ω–æ–≥–æ –∑–∞–º–∫–∞ –∏ —Å –¥–µ—Ç—Å—Ç–≤–∞ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ –∫—É–ª–∏–Ω–∞—Ä–Ω—ã—Ö —Ç–æ–Ω–∫–æ—Å—Ç—è—Ö.",
            "–∏–≥—Ä–∏–∫": "–≠–Ω–µ—Ä–≥–∏—è –∏ –∞–∑–∞—Ä—Ç –≤ –æ–¥–Ω–æ–º –¥—Ä–∞–∫–æ–Ω—å–µ–º —Ç–µ–ª–µ! –†–æ–∂–¥—ë–Ω–Ω—ã–π –≤ –∏–≥—Ä–æ–≤–æ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π, –æ–Ω –≤–µ—Ä–∏—Ç, —á—Ç–æ –∂–∏–∑–Ω—å - —ç—Ç–æ —Å–∞–º–∞—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏–≥—Ä–∞.",
            "—Å–æ–Ω—è": "–ú–∞—Å—Ç–µ—Ä —Å–ª–∞–¥–∫–∏—Ö —Å–Ω–æ–≤ –∏ –ø—É—à–∏—Å—Ç—ã—Ö –æ–±–ª–∞–∫–æ–≤! –°–ø–∏—Ç —Ç–∞–∫ –∫—Ä–µ–ø–∫–æ, —á—Ç–æ –∏–Ω–æ–≥–¥–∞ –ø—Ä–∏—Å–Ω–∏—Ç—Å—è —Å–∞–º–æ–º—É —Å–µ–±–µ –≤–æ —Å–Ω–µ.",
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": "–ñ–∏–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏—è –¥—Ä–∞–∫–æ–Ω—å–µ–≥–æ –º–∏—Ä–∞! –†–æ–∂–¥—ë–Ω–Ω—ã–π –≤–æ –≤—Ä–µ–º—è –≥—Ä–æ–∑—ã, –Ω–∞–∫–æ–ø–∏–ª —Å—Ç–æ–ª—å–∫–æ —ç–Ω–µ—Ä–≥–∏–∏, —á—Ç–æ –º–æ–∂–µ—Ç –æ—Å–≤–µ—Ç–∏—Ç—å —Ü–µ–ª—ã–π –≥–æ—Ä–æ–¥.",
            "—Ñ–∏–ª–æ—Å–æ—Ñ": "–ú—É–¥—Ä–µ—Ü –¥—Ä–∞–∫–æ–Ω—å–µ–≥–æ –ø–ª–µ–º–µ–Ω–∏! –†–æ–∂–¥—ë–Ω–Ω—ã–π –ø–æ–¥ –¥—Ä–µ–≤–Ω–∏–º –¥—É–±–æ–º –º—É–¥—Ä–æ—Å—Ç–∏, –≤–∏–¥–∏—Ç —Å–º—ã—Å–ª —Ç–∞–º, –≥–¥–µ –¥—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç –ª–∏—à—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å.",
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": "–ù–µ—É—Ç–æ–º–∏–º—ã–π –∏—Å–∫–∞—Ç–µ–ª—å —Ç–∞–π–Ω –∏ –∑–∞–≥–∞–¥–æ–∫! –†–æ–∂–¥—ë–Ω–Ω—ã–π —Å –∫–∞—Ä—Ç–æ–π –≤ –ª–∞–ø–∫–∞—Ö, –º–µ—á—Ç–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —É–≥–æ–ª–æ–∫ –≤–æ–ª—à–µ–±–Ω–æ–≥–æ –º–∏—Ä–∞."
        }
        return descriptions.get(trait, "–ó–∞–≥–∞–¥–æ—á–Ω–∞—è –Ω–∞—Ç—É—Ä–∞ —Å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º.")
    
    def _get_trait_strengths(self, trait: str) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        strengths = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–û—Ç–ª–∏—á–Ω–æ–µ –æ–±–æ–Ω—è–Ω–∏–µ –¥–ª—è –∫–æ—Ñ–µ", "–ó–Ω–∞–µ—Ç –≤—Å–µ —Å–æ—Ä—Ç–∞ –∏ –º–µ—Ç–æ–¥—ã –∑–∞–≤–∞—Ä–∫–∏", "–ë—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∑–µ—Ä–µ–Ω"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å", "–ë–æ–≥–∞—Ç—ã–π —Å–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å", "–ü–æ–Ω–∏–º–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["–≠–º–ø–∞—Ç–∏—è –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —ç–º–æ—Ü–∏–π", "–£–º–µ–Ω–∏–µ —É—Ç–µ—à–∞—Ç—å", "–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞"],
            "—á–∏—Å—Ç—é–ª—è": ["–í–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º", "–ê–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å", "–ó–Ω–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ —É—Ö–æ–¥—É"],
            "–≥—É—Ä–º–∞–Ω": ["–ò–∑—ã—Å–∫–∞–Ω–Ω—ã–π –≤–∫—É—Å", "–ó–Ω–∞–Ω–∏–µ –∫—É–ª–∏–Ω–∞—Ä–∏–∏", "–£–º–µ–Ω–∏–µ —Å–æ—á–µ—Ç–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã"],
            "–∏–≥—Ä–∏–∫": ["–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è", "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∞–∑–∞—Ä—Ç"],
            "—Å–æ–Ω—è": ["–£–º–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ –∑–∞—Å—ã–ø–∞—Ç—å", "–ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞", "–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω–æ—Å—Ç—å"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–ù–µ–∏—Å—Å—è–∫–∞–µ–º–∞—è —ç–Ω–µ—Ä–≥–∏—è", "–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å", "–û–ø—Ç–∏–º–∏–∑–º"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["–ì–ª—É–±–æ–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ", "–ú—É–¥—Ä–æ—Å—Ç—å", "–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —É–º"]
        }
        return strengths.get(trait, [])
    
    def _get_trait_weaknesses(self, trait: str) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        weaknesses = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–†–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –∫–æ—Ñ–µ", "–ü—Ä–∏–≤–µ—Ä–µ–¥–ª–∏–≤–æ—Å—Ç—å –≤ —Å–æ—Ä—Ç–∞—Ö", "–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–≤—ã–∫–∞–Ω–∏–µ –∫ –∫–æ—Ñ–µ–∏–Ω—É"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["–†–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å –≤ –±—ã—Ç—É", "–§–∏–∑–∏—á–µ—Å–∫–∞—è —Å–ª–∞–±–æ—Å—Ç—å", "–ó–∞–º–∫–Ω—É—Ç–æ—Å—Ç—å"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["–û–±–∏–¥—á–∏–≤–æ—Å—Ç—å", "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–∏–º–∞–Ω–∏—è", "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ä–∞–Ω–∏–º–æ—Å—Ç—å"],
            "—á–∏—Å—Ç—é–ª—è": ["–ë—Ä–µ–∑–≥–ª–∏–≤–æ—Å—Ç—å", "–ü–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º", "–¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏–∑-–∑–∞ –≥—Ä—è–∑–∏"],
            "–≥—É—Ä–º–∞–Ω": ["–ü—Ä–∏–≤–µ—Ä–µ–¥–ª–∏–≤–æ—Å—Ç—å –≤ –µ–¥–µ", "–í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è", "–†–∞—Å—Ç–æ—á–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"],
            "–∏–≥—Ä–∏–∫": ["–ù–µ—Ç–µ—Ä–ø–µ–ª–∏–≤–æ—Å—Ç—å", "–°–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥—É—Ö", "–ü—Ä–µ–Ω–µ–±—Ä–µ–∂–µ–Ω–∏–µ –æ—Ç–¥—ã—Ö–æ–º"],
            "—Å–æ–Ω—è": ["–ú–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–í—è–ª–æ—Å—Ç—å –ø–æ—Å–ª–µ —Å–Ω–∞", "–¢—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å —Ä–∞–Ω–Ω–∏–º –ø–æ–¥—ä–µ–º–æ–º"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–ì–∏–ø–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", "–ù–µ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–¢—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ–º"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["–ò–∑–ª–∏—à–Ω—è—è –∑–∞–¥—É–º—á–∏–≤–æ—Å—Ç—å", "–û—Ç—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ—Å—Ç—å", "–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–†–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å", "–ë–µ—Å–ø–æ—Ä—è–¥–æ–∫", "–õ—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ –±–µ–∑ –º–µ—Ä—ã"]
        }
        return weaknesses.get(trait, [])
    
    def _generate_favorites(self) -> Dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª—é–±–∏–º—ã–µ –≤–µ—â–∏ –¥—Ä–∞–∫–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞")
        
        # –í–°–ï –í–û–ó–ú–û–ñ–ù–´–ï –í–ê–†–ò–ê–ù–¢–´
        coffee_types = ["—ç—Å–ø—Ä–µ—Å—Å–æ", "–ª–∞—Ç—Ç–µ", "–∫–∞–ø—É—á–∏–Ω–æ", "—Ä–∞—Ñ", "–∞–º–µ—Ä–∏–∫–∞–Ω–æ", "–º–æ–∫–∫–æ", "–≥–ª—è—Å—Å–µ", "—Ñ—Ä–∞–ø–ø–µ"]
        sweets = ["–ø–µ—á–µ–Ω—å–µ", "—à–æ–∫–æ–ª–∞–¥", "–∑–µ—Ñ–∏—Ä", "–ø—Ä—è–Ω–∏–∫", "–º–∞—Ä–º–µ–ª–∞–¥", "–ø–∏—Ä–æ–∂–Ω–æ–µ", "–∫–µ–∫—Å", "–ø–æ–Ω—á–∏–∫", "–ø–∏—Ä–æ–≥"]
        book_genres = ["—Ñ—ç–Ω—Ç–µ–∑–∏", "–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", "—Å–∫–∞–∑–∫–∏", "–¥–µ—Ç–µ–∫—Ç–∏–≤", "–ø–æ—ç–∑–∏—è", "—Ä–æ–º–∞–Ω", "–Ω–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", "–∏—Å—Ç–æ—Ä–∏—è"]
        colors = ["—Å–∏–Ω–∏–π", "–∑–µ–ª–µ–Ω—ã–π", "–∫—Ä–∞—Å–Ω—ã–π", "—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π", "–∑–æ–ª–æ—Ç–æ–π", "—Å–µ—Ä–µ–±—Ä—è–Ω—ã–π", "–±–∏—Ä—é–∑–æ–≤—ã–π", "–∏–∑—É–º—Ä—É–¥–Ω—ã–π"]
        activities = ["–∏–≥—Ä—ã", "—á—Ç–µ–Ω–∏–µ", "—Å–æ–Ω", "–ø—Ä–æ–≥—É–ª–∫–∏", "—Ä–∏—Å–æ–≤–∞–Ω–∏–µ", "–ø–µ–Ω–∏–µ", "—Ç–∞–Ω—Ü—ã", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"]
        
        # –û–°–ù–û–í–ù–´–ï –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø –ü–û –•–ê–†–ê–ö–¢–ï–†–£
        favorites = {
            "–∫–æ—Ñ–µ": random.choice(coffee_types),
            "—Å–ª–∞–¥–æ—Å—Ç—å": random.choice(sweets),
            "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": random.choice(book_genres),
            "—Ü–≤–µ—Ç": random.choice(colors),
            "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": random.choice(activities),
            "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": random.choice(["—É—Ç—Ä–æ", "–¥–µ–Ω—å", "–≤–µ—á–µ—Ä", "–Ω–æ—á—å"]),
            "–ø–æ–≥–æ–¥–∞": random.choice(["—Å–æ–ª–Ω–µ—á–Ω–æ", "–¥–æ–∂–¥–ª–∏–≤–æ", "—Å–Ω–µ–∂–Ω–æ", "–≤–µ—Ç—Ä–µ–Ω–æ"]),
            "–º—É–∑–∏–∫–∞": random.choice(["–∫–ª–∞—Å—Å–∏–∫–∞", "–ø–æ–ø", "—Ä–æ–∫", "–¥–∂–∞–∑", "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è"])
        }
        
        # –û–°–û–ë–´–ï –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø –ü–û –•–ê–†–ê–ö–¢–ï–†–£
        trait_preferences = {
            "–∫–æ—Ñ–µ–º–∞–Ω": {"–∫–æ—Ñ–µ": "—ç—Å–ø—Ä–µ—Å—Å–æ", "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–¥–µ–≥—É—Å—Ç–∞—Ü–∏—è –∫–æ—Ñ–µ", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "—É—Ç—Ä–æ"},
            "–∫–Ω–∏–≥–æ—á–µ–π": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—á—Ç–µ–Ω–∏–µ", "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": "—Ñ—ç–Ω—Ç–µ–∑–∏", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–≤–µ—á–µ—Ä"},
            "–Ω–µ–∂–µ–Ω–∫–∞": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–æ–±–Ω–∏–º–∞—à–∫–∏", "—Ü–≤–µ—Ç": "—Ä–æ–∑–æ–≤—ã–π", "–º—É–∑–∏–∫–∞": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è"},
            "—á–∏—Å—Ç—é–ª—è": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—É—Ö–æ–¥", "—Ü–≤–µ—Ç": "–±–µ–ª—ã–π", "–ø–æ–≥–æ–¥–∞": "—Å–æ–ª–Ω–µ—á–Ω–æ"},
            "–≥—É—Ä–º–∞–Ω": {"—Å–ª–∞–¥–æ—Å—Ç—å": "–ø–∏—Ä–æ–∂–Ω–æ–µ", "–∫–æ—Ñ–µ": "–º–æ–∫–∫–æ", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–¥–µ–Ω—å"},
            "–∏–≥—Ä–∏–∫": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–∏–≥—Ä—ã", "—Å–ª–∞–¥–æ—Å—Ç—å": "–ø–æ–Ω—á–∏–∫", "–º—É–∑–∏–∫–∞": "–ø–æ–ø"},
            "—Å–æ–Ω—è": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Å–æ–Ω", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–Ω–æ—á—å", "–ø–æ–≥–æ–¥–∞": "–¥–æ–∂–¥–ª–∏–≤–æ"},
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Å–ø–æ—Ä—Ç", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "—É—Ç—Ä–æ", "–º—É–∑–∏–∫–∞": "—Ä–æ–∫"},
            "—Ñ–∏–ª–æ—Å–æ—Ñ": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è", "–º—É–∑–∏–∫–∞": "–∫–ª–∞—Å—Å–∏–∫–∞", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–≤–µ—á–µ—Ä"},
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": "–Ω–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", "—Ü–≤–µ—Ç": "–∑–µ–ª–µ–Ω—ã–π"}
        }
        
        if main_trait in trait_preferences:
            favorites.update(trait_preferences[main_trait])
        
        return favorites
    
    def update_over_time(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º - –£–ú–ï–ù–¨–®–ê–ï–¢–°–Ø –ù–ê 5% –í –ß–ê–°"""
        try:
            now = datetime.now()
            last_update = datetime.fromisoformat(self.last_update)
            hours_passed = (now - last_update).total_seconds() / 3600
            
            if hours_passed < 0.1:  # –ú–µ–Ω—å—à–µ 6 –º–∏–Ω—É—Ç - –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º
                return
            
            # –£–ú–ï–ù–¨–®–ï–ù–ò–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô –ù–ê 5% –í –ß–ê–° (–±—ã–ª–æ 10%)
            # –î–ª—è –∫–æ—Ñ–µ, —ç–Ω–µ—Ä–≥–∏–∏, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è, –ø—É—à–∏—Å—Ç–æ—Å—Ç–∏, —á–∏—Å—Ç–æ—Ç—ã, –∑–¥–æ—Ä–æ–≤—å—è
            decay_rates = {
                "–∫–æ—Ñ–µ": 5.0,           # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
                "—ç–Ω–µ—Ä–≥–∏—è": 5.0,        # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
                "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 5.0,     # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
                "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 5.0,     # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
                "—á–∏—Å—Ç–æ—Ç–∞": 5.0,        # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
                "–∑–¥–æ—Ä–æ–≤—å–µ": 5.0        # –ë—ã–ª–æ 10.0 - –¢–ï–ü–ï–†–¨ 5%
            }
            
            growth_rates = {
                "—Å–æ–Ω": 5.0,            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 5% –≤ —á–∞—Å (–±—ã–ª–æ 10%)
                "–∞–ø–ø–µ—Ç–∏—Ç": 5.0,        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 5% –≤ —á–∞—Å (–±—ã–ª–æ 10%)
            }
            
            # –ü–†–ò–ú–ï–ù–Ø–ï–ú –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ò –û–ö–†–£–ì–õ–Ø–ï–ú –î–û –¶–ï–õ–´–•
            for stat, rate in decay_rates.items():
                if stat in self.stats:
                    change = round(rate * hours_passed, 1)  # –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 1 –∑–Ω–∞–∫–∞
                    new_value = max(0, self.stats[stat] - change)
                    self.stats[stat] = int(new_value)  # –ü—Ä–∏–≤–æ–¥–∏–º –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É
            
            for stat, rate in growth_rates.items():
                if stat in self.stats:
                    change = round(rate * hours_passed, 1)  # –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 1 –∑–Ω–∞–∫–∞
                    new_value = min(100, self.stats[stat] + change)
                    self.stats[stat] = int(new_value)  # –ü—Ä–∏–≤–æ–¥–∏–º –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É
            
            # –•–ê–†–ê–ö–¢–ï–†–ù–´–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–´ –î–õ–Ø –°–¢–ê–¢–û–í
            main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
            trait_modifiers = self._get_trait_stat_modifiers(main_trait, hours_passed)
            
            for stat, modifier in trait_modifiers.items():
                if stat in self.stats:
                    new_value = max(0, min(100, self.stats[stat] + modifier))
                    self.stats[stat] = int(new_value)
            
            # –ù–ê–°–¢–†–û–ï–ù–ò–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û –ó–ê–í–ò–°–ò–¢ –û–¢ –í–°–ï–• –§–ê–ö–¢–û–†–û–í - –≤—Å–µ–≥–¥–∞ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
            mood_changes = []
            
            # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
            if self.stats["–∫–æ—Ñ–µ"] > 70:
                mood_changes.append(2)  # –ë—ã–ª–æ 3
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 70:
                mood_changes.append(2)  # –ë—ã–ª–æ 3
            if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] > 70:
                mood_changes.append(1)  # –ë—ã–ª–æ 2
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] > 70:
                mood_changes.append(1)  # –ë—ã–ª–æ 2
            if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] > 85:
                mood_changes.append(2)  # –ë—ã–ª–æ 3
            
            # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã (–±–æ–ª–µ–µ –º—è–≥–∫–∏–µ)
            if self.stats["–∫–æ—Ñ–µ"] < 30:
                mood_changes.append(-3)  # –ë—ã–ª–æ -5
            if self.stats["—Å–æ–Ω"] > 70:
                mood_changes.append(-2)  # –ë—ã–ª–æ -4
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 70:
                mood_changes.append(-2)  # –ë—ã–ª–æ -4
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 30:
                mood_changes.append(-3)  # –ë—ã–ª–æ -5
            if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 40:
                mood_changes.append(-2)  # –ë—ã–ª–æ -3
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 40:
                mood_changes.append(-2)  # –ë—ã–ª–æ -3
            if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] < 60:
                mood_changes.append(-5)  # –ë—ã–ª–æ -8
            
            # –£—á–∏—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä
            character_mood_modifiers = {
                "–Ω–µ–∂–µ–Ω–∫–∞": -2 if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 50 else 0,
                "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": -3 if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 40 else 1,
                "—Ñ–∏–ª–æ—Å–æ—Ñ": 1,  # –§–∏–ª–æ—Å–æ—Ñ –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ –ø–µ—Ä–µ–º–µ–Ω–∞–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
                "–∏–≥—Ä–∏–∫": -1 if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 30 else 0,
                "—Å–æ–Ω—è": 0 if self.stats["—Å–æ–Ω"] > 50 else -1
            }
            
            if main_trait in character_mood_modifiers:
                mood_changes.append(character_mood_modifiers[main_trait])
            
            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è - –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ —Ü–µ–ª–æ–≥–æ
            total_mood_change = sum(mood_changes)
            new_mood = max(0, min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + total_mood_change))
            self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = int(new_mood)
            
            # –ó–î–û–†–û–í–¨–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û –ó–ê–í–ò–°–ò–¢ –û–¢ –û–°–ù–û–í–ù–´–• –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô - –≤—Å–µ–≥–¥–∞ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
            health_factors = []
            
            # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –≤–ª–∏—è–Ω–∏—è (–±–æ–ª–µ–µ –º—è–≥–∫–∏–µ)
            if self.stats["–∫–æ—Ñ–µ"] < 20:
                health_factors.append(-2)  # –ë—ã–ª–æ -3
            if self.stats["—Å–æ–Ω"] > 90:
                health_factors.append(-1)  # –ë—ã–ª–æ -2
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 90:
                health_factors.append(-1)  # –ë—ã–ª–æ -2
            if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 20:
                health_factors.append(-3)  # –ë—ã–ª–æ -5
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 15:
                health_factors.append(-2)  # –ë—ã–ª–æ -3
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 30:
                health_factors.append(-1)  # –ë—ã–ª–æ -2
            
            # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ —Ö–æ—Ä–æ—à–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω–æ–µ)
            if 50 <= self.stats["–∫–æ—Ñ–µ"] <= 80:
                health_factors.append(2)  # –ë—ã–ª–æ 1
            if self.stats["—Å–æ–Ω"] < 60:
                health_factors.append(2)  # –ë—ã–ª–æ 1
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] < 60:
                health_factors.append(2)  # –ë—ã–ª–æ 1
            if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] > 80:
                health_factors.append(3)  # –ë—ã–ª–æ 2
            if 60 <= self.stats["—ç–Ω–µ—Ä–≥–∏—è"] <= 80:
                health_factors.append(2)  # –ë—ã–ª–æ 1
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] > 80:
                health_factors.append(2)  # –ë—ã–ª–æ 1
            
            total_health_change = sum(health_factors)
            new_health = max(0, min(100, self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] + total_health_change))
            self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] = int(new_health)
            
            # –û–ì–†–ê–ù–ò–ß–ò–í–ê–ï–ú –í–°–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò –¶–ï–õ–´–ú–ò –ß–ò–°–õ–ê–ú–ò –û–¢ 0 –î–û 100
            for stat in self.stats:
                self.stats[stat] = max(0, min(100, int(self.stats[stat])))
            
            self.last_update = now.isoformat()
            
        except Exception as e:
            # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
            self.last_update = datetime.now().isoformat()
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ update_over_time: {e}")
    
    def _get_trait_stat_modifiers(self, trait: str, hours_passed: float) -> Dict[str, float]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        # –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (–≤ —á–∞—Å)
        modifiers = {
            "–∫–æ—Ñ–µ–º–∞–Ω": {"–∫–æ—Ñ–µ": -6.0, "—ç–Ω–µ—Ä–≥–∏—è": -4.0},  # –ë—ã—Å—Ç—Ä–µ–µ —Ç–µ—Ä—è–µ—Ç –∫–æ—Ñ–µ –∏ —ç–Ω–µ—Ä–≥–∏—é
            "–∫–Ω–∏–≥–æ—á–µ–π": {"—Å–æ–Ω": 3.0, "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 0.5},  # –ú–µ–¥–ª–µ–Ω–Ω–µ–µ —Ö–æ—á–µ—Ç —Å–ø–∞—Ç—å, —É—á–∏—Ç—Å—è
            "–Ω–µ–∂–µ–Ω–∫–∞": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": -4.0, "—Å–æ–Ω": 2.0}, # –ë—ã—Å—Ç—Ä–µ–µ —Ç–µ—Ä—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
            "—á–∏—Å—Ç—é–ª—è": {"–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": -6.0, "—á–∏—Å—Ç–æ—Ç–∞": -6.0}, # –ë—ã—Å—Ç—Ä–µ–µ –ø–∞—á–∫–∞–µ—Ç—Å—è
            "–≥—É—Ä–º–∞–Ω": {"–∞–ø–ø–µ—Ç–∏—Ç": 6.0, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": -3.0}, # –ë—ã—Å—Ç—Ä–µ–µ –≥–æ–ª–æ–¥–∞–µ—Ç
            "–∏–≥—Ä–∏–∫": {"—ç–Ω–µ—Ä–≥–∏—è": -6.0, "—Å–æ–Ω": 2.0}, # –ë—ã—Å—Ç—Ä–µ–µ —Ç–µ—Ä—è–µ—Ç —ç–Ω–µ—Ä–≥–∏—é
            "—Å–æ–Ω—è": {"—Å–æ–Ω": 8.0, "—ç–Ω–µ—Ä–≥–∏—è": 3.0}, # –ë—ã—Å—Ç—Ä–µ–µ —Ö–æ—á–µ—Ç —Å–ø–∞—Ç—å, –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ç–µ—Ä—è–µ—Ç —ç–Ω–µ—Ä–≥–∏—é
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {"—ç–Ω–µ—Ä–≥–∏—è": -3.0, "—Å–æ–Ω": -2.0}, # –ú–µ–¥–ª–µ–Ω–Ω–µ–µ —Ç–µ—Ä—è–µ—Ç —ç–Ω–µ—Ä–≥–∏—é
            "—Ñ–∏–ª–æ—Å–æ—Ñ": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": -2.0, "—Å–æ–Ω": 1.0}, # –£—Å—Ç–æ–π—á–∏–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": {"—ç–Ω–µ—Ä–≥–∏—è": -4.0, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 1.0} # –õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π = —Å—á–∞—Å—Ç–ª–∏–≤—ã–π
        }
        
        base_mods = modifiers.get(trait, {})
        # –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è
        return {stat: mod * hours_passed for stat, mod in base_mods.items()}
    
    def add_experience(self, amount: int) -> int:
        """–î–æ–±–∞–≤–ª—è–µ—Ç –æ–ø—ã—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è"""
        try:
            self.experience += amount
            levels_gained = 0
            
            while self.experience >= 100:
                self.experience -= 100
                self.level += 1
                levels_gained += 1
                
                # –ü–†–ò –ü–û–í–´–®–ï–ù–ò–ò –£–†–û–í–ù–Ø
                # –£–ª—É—á—à–∞–µ–º –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–µ–º–Ω–æ–≥–æ
                for stat in ["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", "—ç–Ω–µ—Ä–≥–∏—è", "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å", "—á–∏—Å—Ç–æ—Ç–∞", "–∑–¥–æ—Ä–æ–≤—å–µ"]:
                    if stat in self.stats:
                        self.stats[stat] = min(100, self.stats[stat] + 8)  # –ë—ã–ª–æ 5
                
                # –£–ª—É—á—à–∞–µ–º –Ω–∞–≤—ã–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞
                self._improve_skills_on_level_up()
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∑–æ–ª–æ—Ç–æ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
                self.gold += 25 * self.level  # –ë—ã–ª–æ 20
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                self._check_level_achievements()
            
            return levels_gained
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ add_experience: {e}")
            return 0
    
    def _improve_skills_on_level_up(self):
        """–£–ª—É—á—à–∞–µ—Ç –Ω–∞–≤—ã–∫–∏ –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
        
        # –ù–∞–≤—ã–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–ª—É—á—à–∞—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞
        trait_skills = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è", "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º", "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö"],
            "—á–∏—Å—Ç—é–ª—è": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–≤—è–∑–∞–ª—å–Ω–∞—è_—Å–Ω–æ—Ä–æ–≤–∫–∞"],
            "–≥—É—Ä–º–∞–Ω": ["–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ", "–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"],
            "–∏–≥—Ä–∏–∫": ["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è", "–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å", "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
            "—Å–æ–Ω—è": ["–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å", "–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è", "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å", "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è", "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"]
        }
        
        skills_to_improve = trait_skills.get(main_trait, ["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"])
        
        for skill in skills_to_improve:
            if skill in self.skills:
                improvement = random.randint(8, 15)  # –ë—ã–ª–æ 10
                self.skills[skill] = min(100, self.skills[skill] + improvement)
    
    def _check_level_achievements(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è"""
        achievements_to_add = []
        
        if self.level >= 3 and not any(a.get("id") == "level_3" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_3",
                "name": "–Æ–Ω—ã–π —Ö—Ä–∞–Ω–∏—Ç–µ–ª—å",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üéì",
                "unlocked_at": datetime.now().isoformat(),
                "reward": {"gold": 50}
            })
        
        if self.level >= 5 and not any(a.get("id") == "level_5" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_5",
                "name": "–£—á–µ–Ω–∏–∫ –¥—Ä–∞–∫–æ–Ω–æ–≤–æ–¥–∞",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üìö",
                "unlocked_at": datetime.now().isoformat(),
                "reward": {"gold": 100}
            })
        
        if self.level >= 10 and not any(a.get("id") == "level_10" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_10",
                "name": "–û–ø—ã—Ç–Ω—ã–π —Ö—Ä–∞–Ω–∏—Ç–µ–ª—å",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üèÜ",
                "unlocked_at": datetime.now().isoformat(),
                "reward": {"gold": 200, "coffee_beans": 10}
            })
        
        if self.level >= 15 and not any(a.get("id") == "level_15" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_15",
                "name": "–ú–∞—Å—Ç–µ—Ä –¥—Ä–∞–∫–æ–Ω–æ–≤",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üëë",
                "unlocked_at": datetime.now().isoformat(),
                "reward": {"gold": 300, "all_stats": 10}
            })
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        for achievement in achievements_to_add:
            reward = achievement.get("reward", {})
            if "gold" in reward:
                self.gold += reward["gold"]
            if "coffee_beans" in reward:
                if "–∫–æ—Ñ–µ–π–Ω—ã–µ_–∑–µ—Ä–Ω–∞" not in self.inventory:
                    self.inventory["–∫–æ—Ñ–µ–π–Ω—ã–µ_–∑–µ—Ä–Ω–∞"] = 0
                self.inventory["–∫–æ—Ñ–µ–π–Ω—ã–µ_–∑–µ—Ä–Ω–∞"] += reward["coffee_beans"]
            if "all_stats" in reward:
                for stat in self.stats:
                    self.stats[stat] = min(100, self.stats[stat] + reward["all_stats"])
        
        self.achievements.extend(achievements_to_add)
    
    def apply_action(self, action_type: str, action_data: Dict = None) -> Dict:
        """–ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∫ –¥—Ä–∞–∫–æ–Ω—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""
        if action_data is None:
            action_data = {}
        
        result = {
            "success": True,
            "message": "",
            "stat_changes": {},
            "skill_changes": {},
            "level_up": False,
            "gold_earned": 0,
            "special_effect": None,
            "character_message": ""  # –ù–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        }
        
        try:
            # –û–°–ù–û–í–ù–´–ï –≠–§–§–ï–ö–¢–´ –î–ï–ô–°–¢–í–ò–ô (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ, —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞) - –£–í–ï–õ–ò–ß–ï–ù–´
            base_effects = {
                "–∫–æ—Ñ–µ": {
                    "–∫–æ—Ñ–µ": 50,      # –ë—ã–ª–æ 40
                    "—Å–æ–Ω": -15,      # –ë—ã–ª–æ -20
                    "—ç–Ω–µ—Ä–≥–∏—è": 35,   # –ë—ã–ª–æ 30
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, # –ë—ã–ª–æ 15
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 8    # –ë—ã–ª–æ 5
                },
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": {
                    "–∞–ø–ø–µ—Ç–∏—Ç": -50,  # –ë—ã–ª–æ -40
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, # –ë—ã–ª–æ 20
                    "—ç–Ω–µ—Ä–≥–∏—è": 15,   # –ë—ã–ª–æ 10
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5    # –ë—ã–ª–æ 3
                },
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 35, # –ë—ã–ª–æ 30
                    "—Å–æ–Ω": -10,      # –ë—ã–ª–æ -15
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 8    # –ë—ã–ª–æ 5
                },
                "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 60, # –ë—ã–ª–æ 50
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, # –ë—ã–ª–æ 15
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5    # –ë—ã–ª–æ 3
                },
                "—Å–æ–Ω": {
                    "—Å–æ–Ω": 60,      # –ë—ã–ª–æ -50
                    "—ç–Ω–µ—Ä–≥–∏—è": 45,   # –ë—ã–ª–æ 40
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, # –ë—ã–ª–æ 20
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 12   # –ë—ã–ª–æ 10
                },
                "–∏–≥—Ä–∞": {
                    "—ç–Ω–µ—Ä–≥–∏—è": -20,  # –ë—ã–ª–æ -25 (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ç–∏—Ç —ç–Ω–µ—Ä–≥–∏–∏)
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 30, # –ë—ã–ª–æ 25
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 8    # –ë—ã–ª–æ 5
                },
                "—É—Ö–æ–¥_–±–∞–∑–æ–≤—ã–π": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 30, # –ë—ã–ª–æ 25
                    "—á–∏—Å—Ç–æ—Ç–∞": 35,   # –ë—ã–ª–æ 30
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20  # –ë—ã–ª–æ 15
                },
                "—É—Ö–æ–¥_—Ä–∞—Å—á–µ—Å–∫–∞": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 50, # –ë—ã–ª–æ 40
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, # –ë—ã–ª–æ 20
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 8    # –ë—ã–ª–æ 5
                },
                "—É—Ö–æ–¥_—à–∞–º–ø—É–Ω—å": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 70, # –ë—ã–ª–æ 60
                    "—á–∏—Å—Ç–æ—Ç–∞": 60,   # –ë—ã–ª–æ 50
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 30, # –ë—ã–ª–æ 25
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 15   # –ë—ã–ª–æ 10
                },
                "—É—Ö–æ–¥_–Ω–æ–∂–Ω–∏—Ü—ã": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 35, # –ë—ã–ª–æ 30
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15, # –ë—ã–ª–æ 10
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5    # –ë—ã–ª–æ 3
                },
                "—É—Ö–æ–¥_–∏–≥—Ä—É—à–∫–∞": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 30, # –ë—ã–ª–æ 25
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 35, # –ë—ã–ª–æ 30
                    "—ç–Ω–µ—Ä–≥–∏—è": -3,   # –ë—ã–ª–æ -5 (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ç–∏—Ç)
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 8    # –ë—ã–ª–æ 5
                },
                "—É—Ö–æ–¥": {  # –î–ª—è –æ–±—â–µ–≥–æ —É—Ö–æ–¥–∞
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 30, # –ë—ã–ª–æ 25
                    "—á–∏—Å—Ç–æ—Ç–∞": 35,   # –ë—ã–ª–æ 30
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, # –ë—ã–ª–æ 15
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5    # –ë—ã–ª–æ 3
                }
            }
            
            # –ù–ê–í–´–ö–ò, –ö–û–¢–û–†–´–ï –£–õ–£–ß–®–ê–Æ–¢–°–Ø –ü–†–ò –î–ï–ô–°–¢–í–ò–Ø–•
            skill_improvements = {
                "–∫–æ—Ñ–µ": ["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ"],
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": ["–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ"],
                "–æ–±–Ω–∏–º–∞—à–∫–∏": ["—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
                "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—Å–æ–Ω": ["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"],
                "–∏–≥—Ä–∞": ["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"],
                "—É—Ö–æ–¥_–±–∞–∑–æ–≤—ã–π": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_—Ä–∞—Å—á–µ—Å–∫–∞": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_—à–∞–º–ø—É–Ω—å": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"],
                "—É—Ö–æ–¥_–Ω–æ–∂–Ω–∏—Ü—ã": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_–∏–≥—Ä—É—à–∫–∞": ["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è", "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
                "—É—Ö–æ–¥": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"]
            }
            
            # –ü–†–ò–ú–ï–ù–Ø–ï–ú –ë–ê–ó–û–í–´–ï –≠–§–§–ï–ö–¢–´ (–≤—Å–µ–≥–¥–∞ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
            if action_type in base_effects:
                for stat, change in base_effects[action_type].items():
                    if stat in self.stats:
                        old_value = self.stats[stat]
                        if stat == "—Å–æ–Ω" or stat == "–∞–ø–ø–µ—Ç–∏—Ç":
                            # –°–æ–Ω –∏ –∞–ø–ø–µ—Ç–∏—Ç —É–º–µ–Ω—å—à–∞—é—Ç—Å—è –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö
                            new_value = max(0, old_value + change)
                        else:
                            # –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è
                            new_value = min(100, old_value + change)
                        
                        self.stats[stat] = int(new_value)  # –ü—Ä–∏–≤–æ–¥–∏–º –∫ —Ü–µ–ª–æ–º—É
                        result["stat_changes"][stat] = self.stats[stat] - old_value
                
                # –£–õ–£–ß–®–ê–ï–ú –ù–ê–í–´–ö–ò (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
                if action_type in skill_improvements:
                    for skill in skill_improvements[action_type]:
                        if skill in self.skills:
                            improvement = random.randint(2, 5)  # –ë—ã–ª–æ 1-3
                            old_skill = self.skills[skill]
                            self.skills[skill] = min(100, old_skill + improvement)
                            result["skill_changes"][skill] = self.skills[skill] - old_skill
                
                # –î–ê–ï–ú –û–ü–´–¢ –ò –ó–û–õ–û–¢–û (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞) - –£–í–ï–õ–ò–ß–ï–ù–û
                exp_gained = random.randint(15, 30)  # –ë—ã–ª–æ 10-25
                gold_gained = random.randint(8, 20)  # –ë—ã–ª–æ 5-15
                
                levels = self.add_experience(exp_gained)
                self.gold += gold_gained
                
                result["gold_earned"] = gold_gained
                
                if levels > 0:
                    result["level_up"] = True
                    result["message"] = f"üéâ {self.name} –¥–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è!"
                
                # –ü–†–û–í–ï–†–Ø–ï–ú –õ–Æ–ë–ò–ú–´–ï –í–ï–©–ò
                main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
                
                # –ë–æ–Ω—É—Å –∑–∞ –ª—é–±–∏–º—É—é —Å–ª–∞–¥–æ—Å—Ç—å –ø—Ä–∏ –∫–æ—Ä–º–ª–µ–Ω–∏–∏
                if action_type == "–∫–æ—Ä–º–ª–µ–Ω–∏–µ" and action_data.get("item_type"):
                    item_type = action_data.get("item_type")
                    if item_type == self.favorites.get("—Å–ª–∞–¥–æ—Å—Ç—å"):
                        mood_bonus = 30  # –ë—ã–ª–æ 20
                        self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_bonus)
                        result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + mood_bonus
                        result["special_effect"] = "favorite"
                        result["character_message"] = f"üéâ {self.name} –æ–±–æ–∂–∞–µ—Ç {item_type}! +{mood_bonus} –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é!"
                        
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å –¥–ª—è –≥—É—Ä–º–∞–Ω–∞
                        if main_trait == "–≥—É—Ä–º–∞–Ω":
                            self.gold += 10
                            result["gold_earned"] += 10
                            result["character_message"] += f"\n‚ú® –ì—É—Ä–º–∞–Ω –¥–æ–≤–æ–ª–µ–Ω! +10 –∑–æ–ª–æ—Ç–∞!"
                
                # –ë–æ–Ω—É—Å –∑–∞ –ª—é–±–∏–º—ã–π –∫–æ—Ñ–µ
                if action_type == "–∫–æ—Ñ–µ" and action_data.get("coffee_type"):
                    coffee_type = action_data.get("coffee_type")
                    coffee_names = {
                        "espresso": "—ç—Å–ø—Ä–µ—Å—Å–æ", "latte": "–ª–∞—Ç—Ç–µ", "cappuccino": "–∫–∞–ø—É—á–∏–Ω–æ",
                        "raf": "—Ä–∞—Ñ", "americano": "–∞–º–µ—Ä–∏–∫–∞–Ω–æ", "mocha": "–º–æ–∫–∫–æ"
                    }
                    coffee_name = coffee_names.get(coffee_type, "")
                    
                    if coffee_name and coffee_name == self.favorites.get("–∫–æ—Ñ–µ"):
                        mood_bonus = 25  # –ë—ã–ª–æ 20
                        self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_bonus)
                        result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + mood_bonus
                        result["special_effect"] = "favorite_coffee"
                        result["character_message"] = f"üéâ {self.name} –æ–±–æ–∂–∞–µ—Ç {coffee_name}! +{mood_bonus} –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é!"
                        
                        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å –¥–ª—è –∫–æ—Ñ–µ–º–∞–Ω–∞
                        if main_trait == "–∫–æ—Ñ–µ–º–∞–Ω":
                            self.stats["–∫–æ—Ñ–µ"] = min(100, self.stats["–∫–æ—Ñ–µ"] + 10)
                            result["stat_changes"]["–∫–æ—Ñ–µ"] = result["stat_changes"].get("–∫–æ—Ñ–µ", 0) + 10
                            result["character_message"] += f"\n‚òï –ö–æ—Ñ–µ–º–∞–Ω –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ! +10 –∫ –∫–æ—Ñ–µ!"
                
                # –ë–æ–Ω—É—Å—ã –∑–∞ –¥–æ–±–∞–≤–∫–∏ –∫ –∫–æ—Ñ–µ
                if action_type == "–∫–æ—Ñ–µ" and action_data.get("addition"):
                    addition = action_data.get("addition")
                    if addition != "none":
                        self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + 8)  # –ë—ã–ª–æ 5
                        result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + 8
                
                # –ë–æ–Ω—É—Å—ã –∑–∞ —Å–ª–∞–¥–æ—Å—Ç–∏ —Å –∫–æ—Ñ–µ
                if action_type == "–∫–æ—Ñ–µ" and action_data.get("snack"):
                    snack = action_data.get("snack")
                    if snack != "none":
                        self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + 15)  # –ë—ã–ª–æ 10
                        result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + 15
                
                # –•–ê–†–ê–ö–¢–ï–†–ù–´–ï –ë–û–ù–£–°–´ (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞) - –£–õ–£–ß–®–ï–ù–´
                character_bonuses = self._get_character_action_bonus(main_trait, action_type)
                
                for stat, bonus in character_bonuses.get("stat_bonuses", {}).items():
                    if stat in self.stats:
                        new_value = max(0, min(100, self.stats[stat] + bonus))
                        self.stats[stat] = int(new_value)
                        result["stat_changes"][stat] = result["stat_changes"].get(stat, 0) + bonus
                
                for skill, bonus in character_bonuses.get("skill_bonuses", {}).items():
                    if skill in self.skills:
                        new_value = min(100, self.skills[skill] + bonus)
                        self.skills[skill] = int(new_value)
                        result["skill_changes"][skill] = result["skill_changes"].get(skill, 0) + bonus
                
                if character_bonuses.get("message"):
                    if result["character_message"]:
                        result["character_message"] += f"\n{character_bonuses['message']}"
                    else:
                        result["character_message"] = character_bonuses['message']
                
                # –û–ë–ù–û–í–õ–Ø–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –î–ï–ô–°–¢–í–ò–ô
                if action_type == "–∫–æ—Ñ–µ":
                    self.action_stats["total_coffees"] += 1
                elif action_type == "–∫–æ—Ä–º–ª–µ–Ω–∏–µ":
                    self.action_stats["total_feeds"] += 1
                elif action_type == "–æ–±–Ω–∏–º–∞—à–∫–∏":
                    self.action_stats["total_hugs"] += 1
                elif action_type == "–∏–≥—Ä–∞":
                    self.action_stats["total_games"] += 1
                elif "—É—Ö–æ–¥" in action_type:
                    self.action_stats["total_care"] += 1
                elif action_type == "—Å–æ–Ω":
                    self.action_stats["total_sleep"] += 1
                
                # –ó–ê–ü–ò–°–´–í–ê–ï–ú –ü–û–°–õ–ï–î–ù–ï–ï –î–ï–ô–°–¢–í–ò–ï
                self.last_actions[action_type] = datetime.now().isoformat()
                
                # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                self.last_update = datetime.now().isoformat()
                
            else:
                result["success"] = False
                result["message"] = f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: {action_type}"
                
        except Exception as e:
            result["success"] = False
            result["message"] = f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è: {str(e)}"
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ apply_action: {e}")
        
        return result
    
    def _get_character_action_bonus(self, trait: str, action_type: str) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–æ–Ω—É—Å—ã –∑–∞ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        bonuses = {
            "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {},
            "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {},
            "—Å–æ–æ–±—â–µ–Ω–∏–µ": ""
        }
        
        # –ú–ê–¢–†–ò–¶–ê –ë–û–ù–£–°–û–í –î–õ–Ø –ö–ê–ñ–î–û–ì–û –•–ê–†–ê–ö–¢–ï–†–ê
        trait_action_bonuses = {
            "–∫–æ—Ñ–µ–º–∞–Ω": {
                "–∫–æ—Ñ–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–∫–æ—Ñ–µ": 15, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ": 8},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚òï –ö–æ—Ñ–µ–º–∞–Ω –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ—Ñ–µ!"
                },
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚òï –ö–æ—Ñ–µ–º–∞–Ω –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –∫–æ—Ñ–µ —Å–ª–∞–¥–æ—Å—Ç—è–º, –Ω–æ —Å–ø–∞—Å–∏–±–æ!"
                }
            },
            "–∫–Ω–∏–≥–æ—á–µ–π": {
                "—Å–æ–Ω": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 5, "—Å–æ–Ω": -10},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å": 8},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üìö –ö–Ω–∏–≥–æ—á–µ–π –æ–±–æ–∂–∞–µ—Ç, –∫–æ–≥–¥–∞ –µ–º—É —á–∏—Ç–∞—é—Ç!"
                },
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üìö –ö–Ω–∏–≥–æ—á–µ–π —Ä–∞–¥ –æ—Ç–≤–ª–µ—á—å—Å—è –æ—Ç –∫–Ω–∏–≥ –¥–ª—è –æ–±—ä—è—Ç–∏–π!"
                }
            },
            "–Ω–µ–∂–µ–Ω–∫–∞": {
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, "—Å–æ–Ω": -8},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üíñ –ù–µ–∂–µ–Ω–∫–∞ –æ–±–æ–∂–∞–µ—Ç –æ–±–Ω–∏–º–∞—à–∫–∏! –ï—â—ë!"
                },
                "—É—Ö–æ–¥": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üíñ –ù–µ–∂–µ–Ω–∫–∞ —Ä–∞—Å—Ü–≤–µ—Ç–∞–µ—Ç –æ—Ç –∑–∞–±–æ—Ç—ã!"
                }
            },
            "—á–∏—Å—Ç—é–ª—è": {
                "—É—Ö–æ–¥": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 30, "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 15, "—á–∏—Å—Ç–æ—Ç–∞": 20},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∞—Ä—Ç–∏—Å—Ç–∏–∑–º": 8},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚ú® –ß–∏—Å—Ç—é–ª—è —Å–∏—è–µ—Ç –æ—Ç —Å—á–∞—Å—Ç—å—è!"
                },
                "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 20, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚ú® –ß–∏—Å—Ç—é–ª—è –æ–±–æ–∂–∞–µ—Ç –±—ã—Ç—å —É—Ö–æ–∂–µ–Ω–Ω—ã–º!"
                }
            },
            "–≥—É—Ä–º–∞–Ω": {
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, "–∞–ø–ø–µ—Ç–∏—Ç": -15},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ": 8},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üç∞ –ì—É—Ä–º–∞–Ω –æ—Ü–µ–Ω–∏–ª –∏–∑—ã—Å–∫–∞–Ω–Ω–æ—Å—Ç—å —É–≥–æ—â–µ–Ω–∏—è!"
                },
                "–∫–æ—Ñ–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üç∞ –ì—É—Ä–º–∞–Ω –Ω–∞—Å–ª–∞–∂–¥–∞–µ—Ç—Å—è –∞—Ä–æ–º–∞—Ç–æ–º –∫–æ—Ñ–µ!"
                }
            },
            "–∏–≥—Ä–∏–∫": {
                "–∏–≥—Ä–∞": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, "—ç–Ω–µ—Ä–≥–∏—è": -5},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üéÆ –ò–≥—Ä–∏–∫ –æ–±–æ–∂–∞–µ—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è!"
                },
                "—É—Ö–æ–¥_–∏–≥—Ä—É—à–∫–∞": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üéÆ –ò–≥—Ä–∏–∫ —Ä–∞–¥ –Ω–æ–≤–æ–π –∏–≥—Ä–µ!"
                }
            },
            "—Å–æ–Ω—è": {
                "—Å–æ–Ω": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"—Å–æ–Ω": -20, "—ç–Ω–µ—Ä–≥–∏—è": 30, "–∑–¥–æ—Ä–æ–≤—å–µ": 15},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö": 5},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üò¥ –°–æ–Ω—è –æ–±–æ–∂–∞–µ—Ç —Å–ª–∞–¥–∫–∏–µ —Å–Ω—ã!"
                },
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"—Å–æ–Ω": 5, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üò¥ –°–æ–Ω—è –≥–æ—Ç–æ–≤ –∑–∞—Å–Ω—É—Ç—å –≤ —Ç–≤–æ–∏—Ö –æ–±—ä—è—Ç–∏—è—Ö!"
                }
            },
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {
                "–∏–≥—Ä–∞": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"—ç–Ω–µ—Ä–≥–∏—è": -10, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚ö° –≠–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä –ø–æ–ª–æ–Ω —Å–∏–ª –¥–ª—è –∏–≥—Ä!"
                },
                "–∫–æ—Ñ–µ": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"—ç–Ω–µ—Ä–≥–∏—è": 20, "–∫–æ—Ñ–µ": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "‚ö° –≠–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä –∑–∞—Ä—è–¥–∏–ª—Å—è –∫–æ—Ñ–µ!"
                }
            },
            "—Ñ–∏–ª–æ—Å–æ—Ñ": {
                "—Å–æ–Ω": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 10, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å": 5},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "ü§î –§–∏–ª–æ—Å–æ—Ñ —Ä–∞–∑–º—ã—à–ª—è–µ—Ç –æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–º..."
                },
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 10},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "ü§î –§–∏–ª–æ—Å–æ—Ñ —Ü–µ–Ω–∏—Ç —Ç–µ–ø–ª–æ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö –æ–±—ä—è—Ç–∏–π."
                }
            },
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": {
                "–∏–≥—Ä–∞": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 8, "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20},
                    "—Å–∫–∏–ª–ª_–±–æ–Ω—É—Å—ã": {"–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è": 8},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –∏–∑—É—á–∞–µ—Ç –Ω–æ–≤—É—é –∏–≥—Ä—É!"
                },
                "—É—Ö–æ–¥": {
                    "—Å—Ç–∞—Ç_–±–æ–Ω—É—Å—ã": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15},
                    "—Å–æ–æ–±—â–µ–Ω–∏–µ": "üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –∏–∑—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ —É—Ö–æ–¥–∞!"
                }
            }
        }
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –±–æ–Ω—É—Å –¥–ª—è —ç—Ç–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏ –¥–µ–π—Å—Ç–≤–∏—è
        if trait in trait_action_bonuses and action_type in trait_action_bonuses[trait]:
            return trait_action_bonuses[trait][action_type]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—É—Ö–æ–¥" –¥–ª—è "—É—Ö–æ–¥_—Ä–∞—Å—á–µ—Å–∫–∞")
        for action_key, bonus_data in trait_action_bonuses.get(trait, {}).items():
            if action_key in action_type or action_type in action_key:
                return bonus_data
        
        return bonuses
    
    def apply_minigame_result(self, game_type: str, won: bool, score: int = 0) -> Dict:
        """–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–Ω–∏-–∏–≥—Ä—ã (–≤—Å–µ–≥–¥–∞ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)"""
        result = {
            "success": True,
            "message": "",
            "stat_changes": {},
            "gold_earned": 0,
            "skill_changes": {},
            "character_message": ""
        }
        
        try:
            main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
            
            # –ë–ê–ó–û–í–´–ï –ù–ê–ì–†–ê–î–´ –ó–ê –ò–ì–†–´ (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞) - –£–í–ï–õ–ò–ß–ï–ù–´
            if won:
                gold = random.randint(15, 40)  # –ë—ã–ª–æ 10-30
                mood_bonus = random.randint(20, 40)  # –ë—ã–ª–æ 15-30
                experience = random.randint(20, 35)  # –ë—ã–ª–æ 15-25
                
                self.gold += gold
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_bonus)
                
                result["gold_earned"] = gold
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = mood_bonus
                
                self.action_stats["total_minigames_won"] += 1
                
                # –£–ª—É—á—à–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏ (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
                self.skills["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] = min(100, self.skills["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] + 5)  # –ë—ã–ª–æ 3
                result["skill_changes"]["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] = 5
                
                # –î–∞–µ–º –æ–ø—ã—Ç
                levels = self.add_experience(experience)
                if levels > 0:
                    result["message"] = f"üéâ {self.name} –¥–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è!"
                
            else:
                mood_penalty = random.randint(-15, -3)  # –ë—ã–ª–æ -20, -5 (–º–µ–Ω—å—à–µ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ)
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = max(0, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_penalty)
                
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = mood_penalty
                self.action_stats["total_minigames_lost"] += 1
                
                # –î–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ –¥–∞–∂–µ –∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
                self.add_experience(random.randint(8, 15))  # –ë—ã–ª–æ 5-10
                
                result["message"] = "üòî –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–≤–µ–∑—ë—Ç –±–æ–ª—å—à–µ!"
            
            # –ë–æ–Ω—É—Å –¥–ª—è –∏–≥—Ä–∏–∫–∞ (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞)
            if main_trait == "–∏–≥—Ä–∏–∫":
                bonus = 20 if won else -3  # –ë—ã–ª–æ 15/-5
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, max(0, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + bonus))
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + bonus
                
                if won:
                    result["character_message"] = "üéÆ –ò–≥—Ä–∏–∫ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç –ø–æ–±–µ–¥—ã! +20 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é"
                else:
                    result["character_message"] = "üéÆ –ò–≥—Ä–∏–∫ –Ω–µ–º–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω –ø–æ—Ä–∞–∂–µ–Ω–∏–µ–º..."
            
            # –ë–æ–Ω—É—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è
            elif main_trait == "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å":
                exp_bonus = 10 if won else 5
                self.add_experience(exp_bonus)
                result["character_message"] = f"üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –∏–∑—É—á–∞–µ—Ç –∏–≥—Ä—É! +{exp_bonus} –æ–ø—ã—Ç–∞"
            
            # –ë–æ–Ω—É—Å –¥–ª—è —ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä–∞
            elif main_trait == "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä":
                energy_bonus = 15 if won else -5
                self.stats["—ç–Ω–µ—Ä–≥–∏—è"] = max(0, min(100, self.stats["—ç–Ω–µ—Ä–≥–∏—è"] + energy_bonus))
                result["stat_changes"]["—ç–Ω–µ—Ä–≥–∏—è"] = result["stat_changes"].get("—ç–Ω–µ—Ä–≥–∏—è", 0) + energy_bonus
                
                if won:
                    result["character_message"] = f"‚ö° –≠–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä –ø–æ–ª–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏! +{energy_bonus} –∫ —ç–Ω–µ—Ä–≥–∏–∏"
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–≥—Ä—ã
            self.last_actions["game"] = datetime.now().isoformat()
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            self.last_update = datetime.now().isoformat()
            
        except Exception as e:
            result["success"] = False
            result["message"] = f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã: {str(e)}"
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ apply_minigame_result: {e}")
        
        return result
    
    def can_perform_action(self, action_type: str) -> Tuple[bool, str]:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"""
        try:
            main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
            
            # –ü–†–û–í–ï–†–ö–ò –î–õ–Ø –†–ê–ó–ù–´–• –î–ï–ô–°–¢–í–ò–ô
            checks = {
                "–∫–æ—Ñ–µ": lambda: (
                    self.stats["–∫–æ—Ñ–µ"] < 90,  # –ë—ã–ª–æ 95
                    f"‚òï {self.name} –µ—â—ë –Ω–µ —Ö–æ—á–µ—Ç –∫–æ—Ñ–µ. –ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ."
                ),
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": lambda: (
                    self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 20,  # –ë—ã–ª–æ 5
                    f"üç™ {self.name} –µ—â—ë –Ω–µ –≥–æ–ª–æ–¥–µ–Ω. –ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ."
                ),
                "–æ–±–Ω–∏–º–∞—à–∫–∏": lambda: (
                    self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 90,  # –ë—ã–ª–æ 95
                    f"ü§ó {self.name} —É–∂–µ –æ—á–µ–Ω—å —Å—á–∞—Å—Ç–ª–∏–≤!"
                ),
                "—É—Ö–æ–¥": lambda: (
                    self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 90 or self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 90,  # –ë—ã–ª–æ 95
                    f"‚ú® {self.name} —É–∂–µ —Ö–æ—Ä–æ—à–æ —É—Ö–æ–∂–µ–Ω!"
                ),
                "—Å–æ–Ω": lambda: (
                    self.stats["—Å–æ–Ω"] > 20,  # –ë—ã–ª–æ 5
                    f"üò¥ {self.name} –µ—â—ë –Ω–µ —Ö–æ—á–µ—Ç —Å–ø–∞—Ç—å!"
                ),
                "–∏–≥—Ä–∞": lambda: (
                    self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 30,  # –ë—ã–ª–æ 20
                    f"‚ö° {self.name} —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª –¥–ª—è –∏–≥—Ä!"
                )
            }
            
            # –•–ê–†–ê–ö–¢–ï–†–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø
            trait_restrictions = {
                "—Å–æ–Ω—è": {
                    "–∏–≥—Ä–∞": (self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 40, f"üò¥ {self.name} —Å–ª–∏—à–∫–æ–º —Å–æ–Ω–Ω—ã–π –¥–ª—è –∏–≥—Ä!"),
                    "–∫–æ—Ñ–µ": (self.stats["—Å–æ–Ω"] > 30, f"üò¥ {self.name} —Ö–æ—á–µ—Ç —Å–ø–∞—Ç—å, –∞ –Ω–µ –∫–æ—Ñ–µ!")
                },
                "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {
                    "—Å–æ–Ω": (self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 80, f"‚ö° {self.name} —Å–ª–∏—à–∫–æ–º —ç–Ω–µ—Ä–≥–∏—á–µ–Ω –¥–ª—è —Å–Ω–∞!"),
                    "–æ–±–Ω–∏–º–∞—à–∫–∏": (self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 90, f"‚ö° {self.name} —Ö–æ—á–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è, –∞ –Ω–µ –æ–±–Ω–∏–º–∞—Ç—å—Å—è!")
                },
                "–≥—É—Ä–º–∞–Ω": {
                    "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": (self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 30, f"üç∞ {self.name} –∂–¥—ë—Ç –æ—Å–æ–±–æ–µ —É–≥–æ—â–µ–Ω–∏–µ!"),
                    "–∫–æ—Ñ–µ": (self.stats["–∫–æ—Ñ–µ"] < 80, f"üç∞ {self.name} —Ö–æ—á–µ—Ç —Ç–æ–ª—å–∫–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–æ—Ñ–µ!")
                },
                "—á–∏—Å—Ç—é–ª—è": {
                    "—É—Ö–æ–¥": (self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 80 or self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 80, 
                            f"‚ú® {self.name} —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∏—Å—Ç!"),
                    "–æ–±–Ω–∏–º–∞—à–∫–∏": (self.stats["—á–∏—Å—Ç–æ—Ç–∞"] > 70, f"‚ú® {self.name} —Å–Ω–∞—á–∞–ª–∞ –¥–æ–ª–∂–µ–Ω –ø–æ–º—ã—Ç—å—Å—è!")
                }
            }
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
            if main_trait in trait_restrictions and action_type in trait_restrictions[main_trait]:
                can_perform, message = trait_restrictions[main_trait][action_type]
                return can_perform, message
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
            if action_type in checks:
                can_perform, message = checks[action_type]()
                return can_perform, message
            
            # –î–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Ä–∞–∑—Ä–µ—à–∞–µ–º
            return True, ""
            
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ can_perform_action: {e}")
            return True, ""  # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —Ä–∞–∑—Ä–µ—à–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
    
    def get_status_summary(self) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–¥–∫—É —Å—Ç–∞—Ç—É—Å–∞ –¥—Ä–∞–∫–æ–Ω–∞"""
        self.update_over_time()
        
        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
        for stat in self.stats:
            self.stats[stat] = int(self.stats[stat])
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        avg_stat = sum(self.stats.values()) / len(self.stats)
        if avg_stat >= 80:
            overall_state = "–û—Ç–ª–∏—á–Ω–æ–µ"
            state_emoji = "‚ú®"
        elif avg_stat >= 60:
            overall_state = "–•–æ—Ä–æ—à–µ–µ"
            state_emoji = "üòä"
        elif avg_stat >= 40:
            overall_state = "–°—Ä–µ–¥–Ω–µ–µ"
            state_emoji = "üòê"
        elif avg_stat >= 20:
            overall_state = "–ü–ª–æ—Ö–æ–µ"
            state_emoji = "üòî"
        else:
            overall_state = "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ"
            state_emoji = "üö®"
        
        return {
            "name": self.name,
            "level": self.level,
            "character": self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞"),
            "character_description": self.character.get("–æ–ø–∏—Å–∞–Ω–∏–µ", ""),
            "overall_state": overall_state,
            "overall_emoji": state_emoji,
            "stats": self.stats.copy(),
            "skills": {k: int(v) for k, v in self.skills.items() if v > 10},  # –¢–æ–ª—å–∫–æ –Ω–∞–≤—ã–∫–∏ –≤—ã—à–µ 10
            "gold": self.gold,
            "experience": f"{self.experience}/100",
            "favorites": self.favorites,
            "achievements_count": len(self.achievements),
            "total_actions": sum(self.action_stats.values()),
            "needs_attention": self._get_needs_attention(),
            "next_level_progress": f"{(self.experience/100)*100:.1f}%"
        }
    
    def _get_needs_attention(self) -> List[str]:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –¥—Ä–∞–∫–æ–Ω—É"""
        needs = []
        
        # –ë–æ–ª–µ–µ –º—è–≥–∫–∏–µ –ø–æ—Ä–æ–≥–∏ (–±—ã–ª–æ 30, —Å—Ç–∞–ª–æ 40 –∏ —Ç.–¥.)
        if self.stats["–∫–æ—Ñ–µ"] < 40:
            needs.append("‚òï –ö–æ—Ñ–µ")
        if self.stats["—Å–æ–Ω"] > 70:
            needs.append("üò¥ –°–æ–Ω")
        if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 70:
            needs.append("üç™ –ï–¥–∞")
        if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 50:
            needs.append("üòä –í–Ω–∏–º–∞–Ω–∏–µ")
        if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 40:
            needs.append("‚ö° –û—Ç–¥—ã—Ö")
        if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 60:
            needs.append("‚ú® –£—Ö–æ–¥")
        if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 60:
            needs.append("üõÅ –ß–∏—Å—Ç–æ—Ç–∞")
        if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] < 80:
            needs.append("‚ù§Ô∏è –ó–∞–±–æ—Ç–∞")
        
        # –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
        trait_needs = {
            "–Ω–µ–∂–µ–Ω–∫–∞": ["–æ–±–Ω–∏–º–∞—à–∫–∏"] if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 70 else [],
            "–∏–≥—Ä–∏–∫": ["–∏–≥—Ä—ã"] if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 60 else [],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["—á—Ç–µ–Ω–∏–µ"] if self.stats["—Å–æ–Ω"] > 50 else [],
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–∫–æ—Ñ–µ"] if self.stats["–∫–æ—Ñ–µ"] < 60 else [],
            "—á–∏—Å—Ç—é–ª—è": ["—É—Ö–æ–¥"] if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 70 else [],
            "–≥—É—Ä–º–∞–Ω": ["–µ–¥–∞"] if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 60 else [],
            "—Å–æ–Ω—è": ["—Å–æ–Ω"] if self.stats["—Å–æ–Ω"] > 60 else [],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å"] if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 70 else [],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è"] if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 60 else [],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–æ—Ç–∫—Ä—ã—Ç–∏—è"] if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 60 else []
        }
        
        needs.extend(trait_needs.get(main_trait, []))
        
        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
        return list(set(needs))
    
    def get_character_info(self) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ –¥—Ä–∞–∫–æ–Ω–∞"""
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞")
        
        # –≠–º–æ–¥–∑–∏ –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–≤
        trait_emojis = {
            "–∫–æ—Ñ–µ–º–∞–Ω": "‚òï",
            "–∫–Ω–∏–≥–æ—á–µ–π": "üìö",
            "–Ω–µ–∂–µ–Ω–∫–∞": "üíñ",
            "—á–∏—Å—Ç—é–ª—è": "‚ú®",
            "–≥—É—Ä–º–∞–Ω": "üç∞",
            "–∏–≥—Ä–∏–∫": "üéÆ",
            "—Å–æ–Ω—è": "üò¥",
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": "‚ö°",
            "—Ñ–∏–ª–æ—Å–æ—Ñ": "ü§î",
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": "üîç"
        }
        
        return {
            "name": main_trait.capitalize(),
            "emoji": trait_emojis.get(main_trait, "üêâ"),
            "description": self.character.get("–æ–ø–∏—Å–∞–Ω–∏–µ", ""),
            "main_trait": main_trait,
            "secondary_traits": self.character.get("–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ", []),
            "strengths": self.character.get("—Å–∏–ª—å–Ω—ã–µ_—Å—Ç–æ—Ä–æ–Ω—ã", []),
            "weaknesses": self.character.get("—Å–ª–∞–±—ã–µ_—Å—Ç–æ—Ä–æ–Ω—ã", []),
            "favorites": self.favorites,
            "preferred_actions": self._get_preferred_actions(main_trait),
            "avoided_actions": self._get_avoided_actions(main_trait)
        }
    
    def _get_preferred_actions(self, trait: str) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        preferences = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–∫–æ—Ñ–µ", "–¥–µ–≥—É—Å—Ç–∞—Ü–∏—è", "—Ä–∞–∑–≥–æ–≤–æ—Ä—ã –æ –∫–æ—Ñ–µ"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["—á—Ç–µ–Ω–∏–µ", "—Å–æ–Ω —Å –∫–Ω–∏–≥–æ–π", "–æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∫–Ω–∏–≥"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["–æ–±–Ω–∏–º–∞—à–∫–∏", "–ª–∞—Å–∫–∞", "–≤–Ω–∏–º–∞–Ω–∏–µ"],
            "—á–∏—Å—Ç—é–ª—è": ["—É—Ö–æ–¥", "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ", "–∫—É–ø–∞–Ω–∏–µ"],
            "–≥—É—Ä–º–∞–Ω": ["–∫–æ—Ä–º–ª–µ–Ω–∏–µ", "–¥–µ–≥—É—Å—Ç–∞—Ü–∏—è", "–∫—É–ª–∏–Ω–∞—Ä–∏—è"],
            "–∏–≥—Ä–∏–∫": ["–∏–≥—Ä—ã", "—Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è", "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"],
            "—Å–æ–Ω—è": ["—Å–æ–Ω", "–æ—Ç–¥—ã—Ö", "—Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–∏–≥—Ä—ã", "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏", "—Å–ø–æ—Ä—Ç"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è", "—á—Ç–µ–Ω–∏–µ", "–±–µ—Å–µ–¥—ã"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["–∏–≥—Ä—ã", "—É—Ö–æ–¥", "–∏–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ"]
        }
        return preferences.get(trait, [])
    
    def _get_avoided_actions(self, trait: str) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–±–µ–≥–∞–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        avoids = {
            "–∫–æ—Ñ–µ–º–∞–Ω": ["–ø–ª–æ—Ö–æ–π –∫–æ—Ñ–µ", "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ—Ñ–µ", "–¥–µ—à–µ–≤—ã–µ –∑–µ—Ä–Ω–∞"],
            "–∫–Ω–∏–≥–æ—á–µ–π": ["—à—É–º", "—Å—É–µ—Ç–∞", "–ø–ª–æ—Ö–∏–µ –∫–Ω–∏–≥–∏"],
            "–Ω–µ–∂–µ–Ω–∫–∞": ["–≥—Ä—É–±–æ—Å—Ç—å", "–æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ", "—Ö–æ–ª–æ–¥"],
            "—á–∏—Å—Ç—é–ª—è": ["–≥—Ä—è–∑—å", "–±–µ—Å–ø–æ—Ä—è–¥–æ–∫", "–ø–ª–æ—Ö–æ–π —É—Ö–æ–¥"],
            "–≥—É—Ä–º–∞–Ω": ["–Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –µ–¥–∞", "–ø—Ä–æ—Å—Ç—ã–µ —Å–ª–∞–¥–æ—Å—Ç–∏", "—Ñ–∞—Å—Ç—Ñ—É–¥"],
            "–∏–≥—Ä–∏–∫": ["—Å–∫—É—á–Ω—ã–µ –∏–≥—Ä—ã", "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–≥—Ä", "–ø—Ä–æ–∏–≥—Ä—ã—à–∏"],
            "—Å–æ–Ω—è": ["—Ä–∞–Ω–Ω–∏–π –ø–æ–¥—ä–µ–º", "—à—É–º", "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–æ—á—å—é"],
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": ["–±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ", "—Å–∫—É–∫–∞", "—Å–æ–Ω"],
            "—Ñ–∏–ª–æ—Å–æ—Ñ": ["–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã", "—Å—É–µ—Ç–∞", "–≥–ª—É–ø–æ—Å—Ç–∏"],
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": ["—Ä—É—Ç–∏–Ω–∞", "—Å–∫—É—á–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è", "–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è"]
        }
        return avoids.get(trait, [])
    
    def to_dict(self) -> Dict:
        """–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç –≤ —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"""
        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
        stats = {k: int(v) for k, v in self.stats.items()}
        skills = {k: int(v) for k, v in self.skills.items()}
        
        return {
            "name": self.name,
            "created_at": self.created_at,
            "stats": stats,  # –£–∂–µ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
            "character": self.character,
            "skills": skills,  # –£–∂–µ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
            "level": self.level,
            "experience": self.experience,
            "gold": self.gold,
            "inventory": self.inventory,
            "habits": self.habits,
            "favorites": self.favorites,
            "action_stats": self.action_stats,
            "achievements": self.achievements,
            "last_actions": self.last_actions,
            "special_effects": self.special_effects,
            "last_update": self.last_update
        }
    
    @classmethod
    def from_dict(cls, data: Dict) -> 'Dragon':
        """–°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∏–∑ —Å–ª–æ–≤–∞—Ä—è"""
        try:
            dragon = cls(data.get("name", "–î—Ä–∞–∫–æ—à–∞"))
            dragon.created_at = data.get("created_at", datetime.now().isoformat())
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ —Ü–µ–ª—ã–º —á–∏—Å–ª–∞–º
            stats = data.get("stats", dragon.stats.copy())
            dragon.stats = {k: int(v) if isinstance(v, (int, float)) else v for k, v in stats.items()}
            
            # –•–∞—Ä–∞–∫—Ç–µ—Ä —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
            character = data.get("character", {})
            if not isinstance(character, dict):
                character = {}
            if "–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞" not in character:
                character["–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞"] = "–Ω–µ–∂–µ–Ω–∫–∞"
            if "–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ" not in character:
                character["–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ"] = []
            if "–æ–ø–∏—Å–∞–Ω–∏–µ" not in character:
                dragon.character = dragon._generate_character()
            else:
                dragon.character = character
            
            # –ù–∞–≤—ã–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ —Ü–µ–ª—ã–º —á–∏—Å–ª–∞–º
            skills = data.get("skills", dragon.skills.copy())
            dragon.skills = {k: int(v) if isinstance(v, (int, float)) else v for k, v in skills.items()}
            
            # –ü—Ä–æ–≥—Ä–µ—Å—Å
            dragon.level = data.get("level", 1)
            dragon.experience = data.get("experience", 0)
            dragon.gold = data.get("gold", 50)
            
            # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ –ø—Ä–∏–≤—ã—á–∫–∏
            dragon.inventory = data.get("inventory", {})
            dragon.habits = data.get("habits", [])
            
            # –õ—é–±–∏–º—ã–µ –≤–µ—â–∏
            dragon.favorites = data.get("favorites", dragon._generate_favorites())
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
            dragon.action_stats = data.get("action_stats", dragon.action_stats.copy())
            
            # –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            dragon.achievements = data.get("achievements", [])
            
            # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
            dragon.last_actions = data.get("last_actions", dragon.last_actions.copy())
            
            # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            dragon.special_effects = data.get("special_effects", dragon.special_effects.copy())
            
            # –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            dragon.last_update = data.get("last_update", datetime.now().isoformat())
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            dragon.update_over_time()
            
            return dragon
            
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥—Ä–∞–∫–æ–Ω–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è: {e}")
            return cls(data.get("name", "–î—Ä–∞–∫–æ—à–∞") if isinstance(data, dict) else "–î—Ä–∞–∫–æ—à–∞")
    
    def get_progress_towards_next_level(self) -> float:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö"""
        return (self.experience / 100) * 100
    
    def get_top_skills(self, limit: int = 3) -> List[Tuple[str, int]]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ø –Ω–∞–≤—ã–∫–æ–≤ –¥—Ä–∞–∫–æ–Ω–∞"""
        sorted_skills = sorted(self.skills.items(), key=lambda x: x[1], reverse=True)
        return sorted_skills[:limit]
    
    def get_health_status(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è"""
        health = self.stats.get("–∑–¥–æ—Ä–æ–≤—å–µ", 95)
        
        if health >= 90:
            return "–û—Ç–ª–∏—á–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ ‚ú®"
        elif health >= 70:
            return "–•–æ—Ä–æ—à–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ üòä"
        elif health >= 50:
            return "–°—Ä–µ–¥–Ω–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ üòê"
        elif health >= 30:
            return "–°–ª–∞–±–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ üòî"
        elif health >= 10:
            return "–ü–ª–æ—Ö–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ üò∑"
        else:
            return "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ üö®"
    
    def get_mood_status(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è"""
        mood = self.stats.get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 80)
        
        if mood >= 90:
            return "–≠–π—Ñ–æ—Ä–∏—è ü•∞"
        elif mood >= 70:
            return "–°—á–∞—Å—Ç—å–µ üòä"
        elif mood >= 50:
            return "–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ üôÇ"
        elif mood >= 30:
            return "–ì—Ä—É—Å—Ç—å üòî"
        elif mood >= 10:
            return "–ü–µ—á–∞–ª—å üò¢"
        else:
            return "–î–µ–ø—Ä–µ—Å—Å–∏—è üò≠"
    
    def get_energy_status(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å —ç–Ω–µ—Ä–≥–∏–∏"""
        energy = self.stats.get("—ç–Ω–µ—Ä–≥–∏—è", 75)
        
        if energy >= 90:
            return "–ü–µ—Ä–µ–∏–∑–±—ã—Ç–æ–∫ —ç–Ω–µ—Ä–≥–∏–∏ ‚ö°"
        elif energy >= 70:
            return "–ú–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏ üí™"
        elif energy >= 50:
            return "–°—Ä–µ–¥–Ω—è—è —ç–Ω–µ—Ä–≥–∏—è üòä"
        elif energy >= 30:
            return "–ú–∞–ª–æ —ç–Ω–µ—Ä–≥–∏–∏ ü•±"
        elif energy >= 10:
            return "–û—á–µ–Ω—å —É—Å—Ç–∞–ª üò¥"
        else:
            return "–ü–æ–ª–Ω–æ–µ –∏—Å—Ç–æ—â–µ–Ω–∏–µ üí§"
    
    def is_happy(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—á–∞—Å—Ç–ª–∏–≤ –ª–∏ –¥—Ä–∞–∫–æ–Ω"""
        return self.stats.get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) >= 70
    
    def needs_urgent_care(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω—É–∂–¥–∞–µ—Ç—Å—è –ª–∏ –¥—Ä–∞–∫–æ–Ω –≤ —Å—Ä–æ—á–Ω–æ–º —É—Ö–æ–¥–µ"""
        return any([
            self.stats.get("–∑–¥–æ—Ä–æ–≤—å–µ", 95) < 30,
            self.stats.get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 80) < 20,
            self.stats.get("—ç–Ω–µ—Ä–≥–∏—è", 75) < 10,
            self.stats.get("–∫–æ—Ñ–µ", 70) < 10,
            self.stats.get("–∞–ø–ø–µ—Ç–∏—Ç", 60) > 90
        ])
    
    def get_daily_care_suggestions(self) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É —É—Ö–æ–¥—É"""
        suggestions = []
        
        if self.stats["–∫–æ—Ñ–µ"] < 40:
            suggestions.append("–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ —É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ—Ñ–µ ‚òï")
        
        if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 60:
            suggestions.append("–ü–æ–∫–æ—Ä–º–∏—Ç–µ –¥—Ä–∞–∫–æ–Ω–∞ üç™")
        
        if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 60:
            suggestions.append("–†–∞—Å—á–µ—à–∏—Ç–µ —à—ë—Ä—Å—Ç–∫—É ‚ú®")
        
        if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 50:
            suggestions.append("–û–±–Ω–∏–º–∏—Ç–µ –¥—Ä–∞–∫–æ–Ω–∞ ü§ó")
        
        if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 40:
            suggestions.append("–î–∞–π—Ç–µ –¥—Ä–∞–∫–æ–Ω—É –æ—Ç–¥–æ—Ö–Ω—É—Ç—å üò¥")
        
        if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 60:
            suggestions.append("–ò—Å–∫—É–ø–∞–π—Ç–µ –¥—Ä–∞–∫–æ–Ω–∞ üõÅ")
        
        # –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
        if main_trait == "–∫–Ω–∏–≥–æ—á–µ–π" and self.stats["—Å–æ–Ω"] > 50:
            suggestions.append("–ü–æ—á–∏—Ç–∞–π—Ç–µ –¥—Ä–∞–∫–æ–Ω—É –ø–µ—Ä–µ–¥ —Å–Ω–æ–º üìö")
        elif main_trait == "–∏–≥—Ä–∏–∫" and self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 50:
            suggestions.append("–ü–æ–∏–≥—Ä–∞–π—Ç–µ —Å –¥—Ä–∞–∫–æ–Ω–æ–º üéÆ")
        elif main_trait == "–Ω–µ–∂–µ–Ω–∫–∞" and self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 70:
            suggestions.append("–ü—Ä–æ—è–≤–∏—Ç–µ –ª–∞—Å–∫—É –∫ –¥—Ä–∞–∫–æ–Ω—É üíñ")
        
        return suggestions[:5]  # –ù–µ –±–æ–ª–µ–µ 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π