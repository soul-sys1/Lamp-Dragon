"""
–ú–û–î–ï–õ–¨ –î–†–ê–ö–û–ù–ê v5.0
–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏–∫—É –¥—Ä–∞–∫–æ–Ω–∞ —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- –ë–æ–ª—å—à–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏ –Ω–∞–≤—ã–∫–æ–≤
- –ù–æ–≤—ã–µ —Å–ª–∞–¥–æ—Å—Ç–∏
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É—Ö–æ–¥–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∏–Ω–∏-–∏–≥—Ä
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–Ω–∞
"""
import random
from datetime import datetime, timedelta
import json
from typing import Dict, List, Optional

class Dragon:
    def __init__(self, name="–î—Ä–∞–∫–æ—à–∞"):
        self.name = name
        self.created_at = datetime.now().isoformat()
        
        # –û–°–ù–û–í–ù–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò (0-100)
        self.stats = {
            "–∫–æ—Ñ–µ": 70,          # –•–æ—á–µ—Ç –∫–æ—Ñ–µ
            "—Å–æ–Ω": 30,           # –•–æ—á–µ—Ç —Å–ø–∞—Ç—å
            "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 80,    # –û–±—â–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
            "–∞–ø–ø–µ—Ç–∏—Ç": 60,       # –ì–æ–ª–æ–¥
            "—ç–Ω–µ—Ä–≥–∏—è": 75,       # –≠–Ω–µ—Ä–≥–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
            "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 90,    # –£—Ö–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —à–µ—Ä—Å—Ç–∏
            "—á–∏—Å—Ç–æ—Ç–∞": 85,       # –û–±—â–∞—è —á–∏—Å—Ç–æ—Ç–∞
            "–∑–¥–æ—Ä–æ–≤—å–µ": 95       # –û–±—â–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ
        }
        
        # –ù–ê–í–´–ö–ò –î–†–ê–ö–û–ù–ê (0-100)
        self.skills = {
            "–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ": 10,      # –ù–∞–≤—ã–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è/–ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ—Ñ–µ
            "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å": 5,         # –õ—é–±–æ–≤—å –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–Ω–∏–≥
            "–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è": 5,          # –ù–∞–≤—ã–∫ –≤ –∏–≥—Ä–∞—Ö
            "–≤—è–∑–∞–ª—å–Ω–∞—è_—Å–Ω–æ—Ä–æ–≤–∫–∞": 0,        # –ù–∞–≤—ã–∫ —Ä—É–∫–æ–¥–µ–ª–∏—è (–¥–ª—è –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)
            "–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ": 0,      # –ù–∞–≤—ã–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –µ–¥–∞
            "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π_—Å–ª—É—Ö": 0,          # –ß—É–≤—Å—Ç–≤–æ —Ä–∏—Ç–º–∞ –∏ –º—É–∑—ã–∫–∏
            "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º": 0,                  # –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            "–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å": 0,              # –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞
            "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 5,                 # –£–º—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            "—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è": 5               # –ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
        }
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä
        self.character = self._generate_character()
        
        # –ü–†–û–ì–†–ï–°–° –ò –≠–ö–û–ù–û–ú–ò–ö–ê
        self.level = 1
        self.experience = 0
        self.gold = 50
        
        # –ò–ù–í–ï–ù–¢–ê–†–¨ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –±–∞–∑–æ–π)
        self.inventory = {}
        
        # –ü–†–ò–í–´–ß–ö–ò
        self.habits = []
        
        # –õ–Æ–ë–ò–ú–´–ï –í–ï–©–ò (–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º)
        self.favorites = self._generate_favorites()
        
        # –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ï–ô–°–¢–í–ò–ô
        self.action_stats = {
            "total_coffees": 0,
            "total_feeds": 0,
            "total_hugs": 0,
            "total_games": 0,
            "total_care": 0,
            "total_sleep": 0,
            "total_minigames_won": 0,
            "total_minigames_lost": 0
        }
        
        # –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
        self.achievements = []
        
        # –ü–û–°–õ–ï–î–ù–ò–ï –î–ï–ô–°–¢–í–ò–Ø (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
        self.last_actions = {
            "coffee": None,
            "feed": None,
            "hug": None,
            "game": None,
            "care": None,
            "sleep": None
        }
        
        # –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        self.last_update = datetime.now().isoformat()
        
        # –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –§–õ–ê–ì–ò
        self.special_effects = {
            "coffee_art_unlocked": False,
            "massage_unlocked": False,
            "bath_unlocked": False,
            "toy_enjoyment": 0  # –ù–∞—Å–∫–æ–ª—å–∫–æ –¥—Ä–∞–∫–æ–Ω—É –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–≥—Ä—É—à–∫–∞
        }
    
    def _generate_character(self) -> Dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –¥—Ä–∞–∫–æ–Ω–∞"""
        traits = [
            "–∫–æ—Ñ–µ–º–∞–Ω",      # –û–±–æ–∂–∞–µ—Ç –∫–æ—Ñ–µ, —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Å–æ—Ä—Ç–∞—Ö
            "—Å–æ–Ω—è",         # –õ—é–±–∏—Ç –ø–æ—Å–ø–∞—Ç—å, –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—ë—Ç
            "–∏–≥—Ä–∏–∫",        # –û–±–æ–∂–∞–µ—Ç –∏–≥—Ä—ã –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è
            "–∫–Ω–∏–≥–æ—á–µ–π",     # –ü—Ä–æ–≤–æ–¥–∏—Ç –¥–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º
            "–Ω–µ–∂–µ–Ω–∫–∞",      # –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ª–∞—Å–∫–∏ –∏ –≤–Ω–∏–º–∞–Ω–∏—è
            "–≥—É—Ä–º–∞–Ω",       # –†–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ –µ–¥–µ –∏ –Ω–∞–ø–∏—Ç–∫–∞—Ö
            "—á–∏—Å—Ç—é–ª—è",      # –°–ª–µ–¥–∏—Ç –∑–∞ —á–∏—Å—Ç–æ—Ç–æ–π, –ª—é–±–∏—Ç —É—Ö–æ–¥
            "–ª–µ–Ω—Ç—è–π",       # –ù–µ –ª—é–±–∏—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –æ—Ç–¥—ã—Ö
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä",  # –í—Å–µ–≥–¥–∞ –ø–æ–ª–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏, –∞–∫—Ç–∏–≤–µ–Ω
            "—Ñ–∏–ª–æ—Å–æ—Ñ",      # –õ—é–±–∏—Ç —Ä–∞–∑–º—ã—à–ª—è—Ç—å, —Å–ø–æ–∫–æ–π–Ω—ã–π
            "–∞—Ä—Ç–∏—Å—Ç",       # –¢–≤–æ—Ä—á–µ—Å–∫–∞—è –Ω–∞—Ç—É—Ä–∞, –ª—é–±–∏—Ç –∏—Å–∫—É—Å—Å—Ç–≤–æ
            "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω",    # –ê–∫—Ç–∏–≤–Ω—ã–π, –ª—é–±–∏—Ç –¥–≤–∏–∂–µ–Ω–∏–µ
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å",# –õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π, –∏–∑—É—á–∞–µ—Ç –≤—Å—ë –≤–æ–∫—Ä—É–≥
            "–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π",  # –û–±—â–∏—Ç–µ–ª—å–Ω—ã–π, –ª—é–±–∏—Ç –∫–æ–º–ø–∞–Ω–∏—é
            "–º–µ—á—Ç–∞—Ç–µ–ª—å"     # –í–∏—Ç–∞–µ—Ç –≤ –æ–±–ª–∞–∫–∞—Ö, —Ñ–∞–Ω—Ç–∞–∑—ë—Ä
        ]
        
        main_trait = random.choice(traits)
        other_traits = [t for t in traits if t != main_trait]
        secondary = random.sample(other_traits, random.randint(1, 3))
        
        return {
            "–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞": main_trait,
            "–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ": secondary,
            "–æ–ø–∏—Å–∞–Ω–∏–µ": self._get_trait_description(main_trait)
        }
    
    def _get_trait_description(self, trait: str) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä—Ç—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        descriptions = {
            "–∫–æ—Ñ–µ–º–∞–Ω": "–û–±–æ–∂–∞–µ—Ç –∫–æ—Ñ–µ –∏ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ –µ–≥–æ —Å–æ—Ä—Ç–∞—Ö. –ú–æ–∂–µ—Ç —á–∞—Å–∞–º–∏ –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–∞—Ö –∑–∞–≤–∞—Ä–∫–∏.",
            "—Å–æ–Ω—è": "–õ—é–±–∏—Ç –ø–æ—Å–ø–∞—Ç—å –∏ –≤–∑–¥—Ä–µ–º–Ω—É—Ç—å. –ß–∞—Å—Ç–æ –∫–ª—é—ë—Ç –Ω–æ—Å–æ–º –≤–æ –≤—Ä–µ–º—è —á—Ç–µ–Ω–∏—è –∏–ª–∏ –∏–≥—Ä.",
            "–∏–≥—Ä–∏–∫": "–û–±–æ–∂–∞–µ—Ç –∏–≥—Ä—ã –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è. –í—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –≤—ã–∑–æ–≤–∞–º –∏ –ø–æ–±–µ–¥–∞–º.",
            "–∫–Ω–∏–≥–æ—á–µ–π": "–ü—Ä–æ–≤–æ–¥–∏—Ç –¥–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º. –ó–Ω–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—Ä–∏–π –∏ –ª–µ–≥–µ–Ω–¥ –æ –¥—Ä–∞–∫–æ–Ω–∞—Ö.",
            "–Ω–µ–∂–µ–Ω–∫–∞": "–¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ª–∞—Å–∫–∏ –∏ –≤–Ω–∏–º–∞–Ω–∏—è. –û–±–æ–∂–∞–µ—Ç –æ–±—ä—è—Ç–∏—è –∏ –Ω–µ–∂–Ω—ã–µ —Å–ª–æ–≤–∞.",
            "–≥—É—Ä–º–∞–Ω": "–†–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ –µ–¥–µ –∏ –Ω–∞–ø–∏—Ç–∫–∞—Ö. –¶–µ–Ω–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –∏–∑—ã—Å–∫–∞–Ω–Ω–æ—Å—Ç—å –≤–∫—É—Å–æ–≤.",
            "—á–∏—Å—Ç—é–ª—è": "–°–ª–µ–¥–∏—Ç –∑–∞ —Å–≤–æ–µ–π —á–∏—Å—Ç–æ—Ç–æ–π. –õ—é–±–∏—Ç, –∫–æ–≥–¥–∞ –µ–≥–æ —Ä–∞—Å—á—ë—Å—ã–≤–∞—é—Ç –∏ —É—Ö–∞–∂–∏–≤–∞—é—Ç –∑–∞ –Ω–∏–º.",
            "–ª–µ–Ω—Ç—è–π": "–ù–µ –ª—é–±–∏—Ç –ª–∏—à–Ω—é—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ª–µ–∂–∞—Ç—å –Ω–∞ –º—è–≥–∫–æ–π –ø–æ–¥—É—à–∫–µ.",
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": "–í—Å–µ–≥–¥–∞ –ø–æ–ª–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏. –ì–æ—Ç–æ–≤ –±–µ–≥–∞—Ç—å –∏ –∏–≥—Ä–∞—Ç—å —Ü–µ–ª—ã–π –¥–µ–Ω—å.",
            "—Ñ–∏–ª–æ—Å–æ—Ñ": "–õ—é–±–∏—Ç —Ä–∞–∑–º—ã—à–ª—è—Ç—å –æ –∂–∏–∑–Ω–∏. –ß–∞—Å—Ç–æ –∑–∞–¥–∞—ë—Ç –≥–ª—É–±–æ–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã.",
            "–∞—Ä—Ç–∏—Å—Ç": "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –Ω–∞—Ç—É—Ä–∞. –õ—é–±–∏—Ç —Ä–∏—Å–æ–≤–∞—Ç—å, –ø–µ—Ç—å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ –≤–µ—â–∏.",
            "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω": "–ê–∫—Ç–∏–≤–Ω—ã–π –∏ –ø–æ–¥–≤–∏–∂–Ω—ã–π. –õ—é–±–∏—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏.",
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": "–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π –∏ —É–º–Ω—ã–π. –ò–∑—É—á–∞–µ—Ç –≤—Å—ë –≤–æ–∫—Ä—É–≥ —Å –±–æ–ª—å—à–∏–º –∏–Ω—Ç–µ—Ä–µ—Å–æ–º.",
            "–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π": "–û–±—â–∏—Ç–µ–ª—å–Ω—ã–π –∏ –≤–µ—Å—ë–ª—ã–π. –õ—é–±–∏—Ç –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞.",
            "–º–µ—á—Ç–∞—Ç–µ–ª—å": "–í–∏—Ç–∞–µ—Ç –≤ –æ–±–ª–∞–∫–∞—Ö. –ß–∞—Å—Ç–æ –ø–æ–≥—Ä—É–∂—ë–Ω –≤ —Å–≤–æ–∏ —Ñ–∞–Ω—Ç–∞–∑–∏–∏ –∏ –º–µ—á—Ç—ã."
        }
        return descriptions.get(trait, "–ó–∞–≥–∞–¥–æ—á–Ω–∞—è –Ω–∞—Ç—É—Ä–∞ —Å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º.")
    
    def _generate_favorites(self) -> Dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª—é–±–∏–º—ã–µ –≤–µ—â–∏ –¥—Ä–∞–∫–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞"""
        main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞")
        
        # –í–°–ï –í–û–ó–ú–û–ñ–ù–´–ï –í–ê–†–ò–ê–ù–¢–´
        coffee_types = ["—ç—Å–ø—Ä–µ—Å—Å–æ", "–ª–∞—Ç—Ç–µ", "–∫–∞–ø—É—á–∏–Ω–æ", "—Ä–∞—Ñ", "–∞–º–µ—Ä–∏–∫–∞–Ω–æ", "–º–æ–∫–∫–æ", "–≥–ª—è—Å—Å–µ", "—Ñ—Ä–∞–ø–ø–µ"]
        sweets = ["–ø–µ—á–µ–Ω—å–µ", "—à–æ–∫–æ–ª–∞–¥", "–∑–µ—Ñ–∏—Ä", "–ø—Ä—è–Ω–∏–∫", "–º–∞—Ä–º–µ–ª–∞–¥", "–ø–∏—Ä–æ–∂–Ω–æ–µ", "–∫–µ–∫—Å", "–ø–æ–Ω—á–∏–∫", "–ø–∏—Ä–æ–≥"]
        book_genres = ["—Ñ—ç–Ω—Ç–µ–∑–∏", "–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", "—Å–∫–∞–∑–∫–∏", "–¥–µ—Ç–µ–∫—Ç–∏–≤", "–ø–æ—ç–∑–∏—è", "—Ä–æ–º–∞–Ω", "–Ω–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", "–∏—Å—Ç–æ—Ä–∏—è"]
        colors = ["—Å–∏–Ω–∏–π", "–∑–µ–ª–µ–Ω—ã–π", "–∫—Ä–∞—Å–Ω—ã–π", "—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π", "–∑–æ–ª–æ—Ç–æ–π", "—Å–µ—Ä–µ–±—Ä—è–Ω—ã–π", "–±–∏—Ä—é–∑–æ–≤—ã–π", "–∏–∑—É–º—Ä—É–¥–Ω—ã–π"]
        activities = ["–∏–≥—Ä—ã", "—á—Ç–µ–Ω–∏–µ", "—Å–æ–Ω", "–ø—Ä–æ–≥—É–ª–∫–∏", "—Ä–∏—Å–æ–≤–∞–Ω–∏–µ", "–ø–µ–Ω–∏–µ", "—Ç–∞–Ω—Ü—ã", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"]
        
        # –û–°–ù–û–í–ù–´–ï –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø –ü–û –•–ê–†–ê–ö–¢–ï–†–£
        favorites = {
            "–∫–æ—Ñ–µ": random.choice(coffee_types),
            "—Å–ª–∞–¥–æ—Å—Ç—å": random.choice(sweets),
            "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": random.choice(book_genres),
            "—Ü–≤–µ—Ç": random.choice(colors),
            "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": random.choice(activities),
            "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": random.choice(["—É—Ç—Ä–æ", "–¥–µ–Ω—å", "–≤–µ—á–µ—Ä", "–Ω–æ—á—å"]),
            "–ø–æ–≥–æ–¥–∞": random.choice(["—Å–æ–ª–Ω–µ—á–Ω–æ", "–¥–æ–∂–¥–ª–∏–≤–æ", "—Å–Ω–µ–∂–Ω–æ", "–≤–µ—Ç—Ä–µ–Ω–æ"]),
            "–º—É–∑—ã–∫–∞": random.choice(["–∫–ª–∞—Å—Å–∏–∫–∞", "–ø–æ–ø", "—Ä–æ–∫", "–¥–∂–∞–∑", "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è"])
        }
        
        # –û–°–û–ë–´–ï –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø –ü–û –•–ê–†–ê–ö–¢–ï–†–£
        trait_preferences = {
            "–∫–æ—Ñ–µ–º–∞–Ω": {"–∫–æ—Ñ–µ": "—ç—Å–ø—Ä–µ—Å—Å–æ", "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–¥–µ–≥—É—Å—Ç–∞—Ü–∏—è –∫–æ—Ñ–µ"},
            "—Å–æ–Ω—è": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Å–æ–Ω", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–Ω–æ—á—å"},
            "–∏–≥—Ä–∏–∫": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–∏–≥—Ä—ã", "—Å–ª–∞–¥–æ—Å—Ç—å": random.choice(["–ø–æ–Ω—á–∏–∫", "–∫–µ–∫—Å"])},
            "–∫–Ω–∏–≥–æ—á–µ–π": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—á—Ç–µ–Ω–∏–µ", "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": "—Ñ—ç–Ω—Ç–µ–∑–∏"},
            "–Ω–µ–∂–µ–Ω–∫–∞": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–æ–±–Ω–∏–º–∞—à–∫–∏", "—Ü–≤–µ—Ç": "—Ä–æ–∑–æ–≤—ã–π"},
            "–≥—É—Ä–º–∞–Ω": {"—Å–ª–∞–¥–æ—Å—Ç—å": "–ø–∏—Ä–æ–∂–Ω–æ–µ", "–∫–æ—Ñ–µ": "–º–æ–∫–∫–æ"},
            "—á–∏—Å—Ç—é–ª—è": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—É—Ö–æ–¥", "—Ü–≤–µ—Ç": "–±–µ–ª—ã–π"},
            "–ª–µ–Ω—Ç—è–π": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–æ—Ç–¥—ã—Ö", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–¥–µ–Ω—å"},
            "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Å–ø–æ—Ä—Ç", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "—É—Ç—Ä–æ"},
            "—Ñ–∏–ª–æ—Å–æ—Ñ": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è", "–º—É–∑—ã–∫–∞": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è"},
            "–∞—Ä—Ç–∏—Å—Ç": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "—Ä–∏—Å–æ–≤–∞–Ω–∏–µ", "—Ü–≤–µ—Ç": "—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π"},
            "—Å–ø–æ—Ä—Ç—Å–º–µ–Ω": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–ø—Ä–æ–≥—É–ª–∫–∏", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "—É—Ç—Ä–æ"},
            "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–∂–∞–Ω—Ä_–∫–Ω–∏–≥": "–Ω–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"},
            "–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–æ–±—â–µ–Ω–∏–µ", "–≤—Ä–µ–º—è_—Å—É—Ç–æ–∫": "–≤–µ—á–µ—Ä"},
            "–º–µ—á—Ç–∞—Ç–µ–ª—å": {"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å": "–º–µ—á—Ç–∞–Ω–∏—è", "–ø–æ–≥–æ–¥–∞": "–æ–±–ª–∞—á–Ω–æ"}
        }
        
        if main_trait in trait_preferences:
            favorites.update(trait_preferences[main_trait])
        
        # –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø –û–¢ –í–¢–û–†–û–°–¢–ï–ü–ï–ù–ù–´–• –ß–ï–†–¢
        secondary_traits = self.character.get("–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ", [])
        for trait in secondary_traits[:2]:  # –ë–µ—Ä–µ–º –º–∞–∫—Å–∏–º—É–º 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —á–µ—Ä—Ç—ã
            if trait in trait_preferences:
                for key, value in trait_preferences[trait].items():
                    if random.random() > 0.7:  # 30% —à–∞–Ω—Å –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ
                        favorites[key] = value
        
        return favorites
    
    def update_over_time(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º"""
        try:
            now = datetime.now()
            last_update = datetime.fromisoformat(self.last_update)
            hours_passed = (now - last_update).total_seconds() / 3600
            
            if hours_passed < 0.5:  # –ú–µ–Ω—å—à–µ 30 –º–∏–Ω—É—Ç
                return
            
            # –°–ö–û–†–û–°–¢–ò –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô
            decay_rates = {
                "–∫–æ—Ñ–µ": 4,           # 4% –≤ —á–∞—Å
                "—ç–Ω–µ—Ä–≥–∏—è": 3,        # 3% –≤ —á–∞—Å
                "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 1,     # 1% –≤ —á–∞—Å
                "—á–∏—Å—Ç–æ—Ç–∞": 1,        # 1% –≤ —á–∞—Å
                "–∑–¥–æ—Ä–æ–≤—å–µ": 0.5      # 0.5% –≤ —á–∞—Å
            }
            
            growth_rates = {
                "—Å–æ–Ω": 2.5,          # 2.5% –≤ —á–∞—Å
                "–∞–ø–ø–µ—Ç–∏—Ç": 2,        # 2% –≤ —á–∞—Å,
            }
            
            # –ü–†–ò–ú–ï–ù–Ø–ï–ú –ò–ó–ú–ï–ù–ï–ù–ò–Ø
            for stat, rate in decay_rates.items():
                if stat in self.stats:
                    self.stats[stat] = max(0, self.stats[stat] - rate * hours_passed)
            
            for stat, rate in growth_rates.items():
                if stat in self.stats:
                    self.stats[stat] = min(100, self.stats[stat] + rate * hours_passed)
            
            # –ù–ê–°–¢–†–û–ï–ù–ò–ï –ó–ê–í–ò–°–ò–¢ –û–¢ –í–°–ï–• –§–ê–ö–¢–û–†–û–í
            mood_changes = []
            
            # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
            if self.stats["–∫–æ—Ñ–µ"] > 80:
                mood_changes.append(5)
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 80:
                mood_changes.append(5)
            if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] > 80:
                mood_changes.append(3)
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] > 80:
                mood_changes.append(3)
            if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] > 90:
                mood_changes.append(5)
            
            # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
            if self.stats["–∫–æ—Ñ–µ"] < 20:
                mood_changes.append(-10)
            if self.stats["—Å–æ–Ω"] > 80:
                mood_changes.append(-8)
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 80:
                mood_changes.append(-8)
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 20:
                mood_changes.append(-10)
            if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 30:
                mood_changes.append(-5)
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 30:
                mood_changes.append(-5)
            if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] < 50:
                mood_changes.append(-15)
            
            # –£—á–∏—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä
            main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
            if main_trait == "–Ω–µ–∂–µ–Ω–∫–∞" and self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 50:
                mood_changes.append(-5)  # –ù–µ–∂–µ–Ω–∫–∞ —Å–∏–ª—å–Ω–µ–µ –≥—Ä—É—Å—Ç–∏—Ç
            elif main_trait == "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä" and self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 30:
                mood_changes.append(-10)  # –≠–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä—É –±–µ–∑ —ç–Ω–µ—Ä–≥–∏–∏ –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ
            
            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
            total_mood_change = sum(mood_changes)
            self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = max(0, min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + total_mood_change))
            
            # –ó–î–û–†–û–í–¨–ï –ó–ê–í–ò–°–ò–¢ –û–¢ –û–°–ù–û–í–ù–´–• –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô
            health_factors = []
            if self.stats["–∫–æ—Ñ–µ"] < 10:
                health_factors.append(-5)
            if self.stats["—Å–æ–Ω"] > 95:
                health_factors.append(-3)
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 95:
                health_factors.append(-3)
            if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 10:
                health_factors.append(-8)
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 5:
                health_factors.append(-5)
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 20:
                health_factors.append(-3)
            
            # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ —Ö–æ—Ä–æ—à–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            if self.stats["–∫–æ—Ñ–µ"] > 50:
                health_factors.append(1)
            if self.stats["—Å–æ–Ω"] < 50:
                health_factors.append(1)
            if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] < 50:
                health_factors.append(1)
            if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] > 80:
                health_factors.append(3)
            if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 50:
                health_factors.append(2)
            if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] > 80:
                health_factors.append(2)
            
            total_health_change = sum(health_factors)
            self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] = max(0, min(100, self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] + total_health_change))
            
            self.last_update = now.isoformat()
            
        except Exception as e:
            self.last_update = datetime.now().isoformat()
            print(f"–û—à–∏–±–∫–∞ –≤ update_over_time: {e}")
    
    def add_experience(self, amount: int) -> int:
        """–î–æ–±–∞–≤–ª—è–µ—Ç –æ–ø—ã—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è"""
        try:
            self.experience += amount
            levels_gained = 0
            
            while self.experience >= 100:
                self.experience -= 100
                self.level += 1
                levels_gained += 1
                
                # –ü–†–ò –ü–û–í–´–®–ï–ù–ò–ò –£–†–û–í–ù–Ø
                # –£–ª—É—á—à–∞–µ–º –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–µ–º–Ω–æ–≥–æ
                for stat in self.stats:
                    if stat not in ["–∫–æ—Ñ–µ", "—Å–æ–Ω", "–∞–ø–ø–µ—Ç–∏—Ç"]:  # –≠—Ç–∏ –Ω–µ —É–ª—É—á—à–∞–µ–º
                        self.stats[stat] = min(100, self.stats[stat] + 5)
                
                # –£–ª—É—á—à–∞–µ–º 2 —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–∞–≤—ã–∫–∞
                available_skills = list(self.skills.keys())
                if available_skills:
                    for _ in range(2):
                        skill = random.choice(available_skills)
                        self.skills[skill] = min(100, self.skills[skill] + 10)
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∑–æ–ª–æ—Ç–æ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
                self.gold += 20 * self.level
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                self._check_level_achievements()
            
            return levels_gained
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ add_experience: {e}")
            return 0
    
    def _check_level_achievements(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è"""
        achievements_to_add = []
        
        if self.level >= 5 and not any(a.get("id") == "level_5" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_5",
                "name": "–£—á–µ–Ω–∏–∫ –¥—Ä–∞–∫–æ–Ω–æ–≤–æ–¥–∞",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üéì",
                "unlocked_at": datetime.now().isoformat()
            })
        
        if self.level >= 10 and not any(a.get("id") == "level_10" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_10",
                "name": "–û–ø—ã—Ç–Ω—ã–π —Ö—Ä–∞–Ω–∏—Ç–µ–ª—å",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üèÜ",
                "unlocked_at": datetime.now().isoformat()
            })
        
        if self.level >= 20 and not any(a.get("id") == "level_20" for a in self.achievements):
            achievements_to_add.append({
                "id": "level_20",
                "name": "–ú–∞—Å—Ç–µ—Ä –¥—Ä–∞–∫–æ–Ω–æ–≤",
                "description": f"–î–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è —Å {self.name}",
                "icon": "üëë",
                "unlocked_at": datetime.now().isoformat()
            })
        
        self.achievements.extend(achievements_to_add)
    
    # ==== –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ú–ï–¢–û–î –î–õ–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–ò ====
    def apply_action(self, action_type: str, action_data: Dict = None) -> Dict:
        """–ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∫ –¥—Ä–∞–∫–æ–Ω—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""
        if action_data is None:
            action_data = {}
        
        result = {
            "success": True,
            "message": "",
            "stat_changes": {},
            "skill_changes": {},
            "level_up": False,
            "gold_earned": 0,
            "special_effect": None
        }
        
        try:
            # –û–°–ù–û–í–ù–´–ï –≠–§–§–ï–ö–¢–´ –î–ï–ô–°–¢–í–ò–ô (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
            base_effects = {
                "–∫–æ—Ñ–µ": {
                    "–∫–æ—Ñ–µ": 40,
                    "—Å–æ–Ω": -20,
                    "—ç–Ω–µ—Ä–≥–∏—è": 30,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5
                },
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": {
                    "–∞–ø–ø–µ—Ç–∏—Ç": -40,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20,
                    "—ç–Ω–µ—Ä–≥–∏—è": 10,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 3
                },
                "–æ–±–Ω–∏–º–∞—à–∫–∏": {
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 30,
                    "—Å–æ–Ω": -15,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5
                },
                "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 50,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 3
                },
                "—Å–æ–Ω": {
                    "—Å–æ–Ω": -50,
                    "—ç–Ω–µ—Ä–≥–∏—è": 40,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 10
                },
                "–∏–≥—Ä–∞": {
                    "—ç–Ω–µ—Ä–≥–∏—è": -25,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5
                },
                "—É—Ö–æ–¥_–±–∞–∑–æ–≤—ã–π": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 25,
                    "—á–∏—Å—Ç–æ—Ç–∞": 30,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15
                },
                "—É—Ö–æ–¥_—Ä–∞—Å—á–µ—Å–∫–∞": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 40,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 5
                },
                "—É—Ö–æ–¥_—à–∞–º–ø—É–Ω—å": {
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 60,
                    "—á–∏—Å—Ç–æ—Ç–∞": 50,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 10
                },
                "–∫–æ—Ñ–µ_–∞—Ä—Ç": {
                    "–∫–æ—Ñ–µ": 30,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 40,
                    "—ç–Ω–µ—Ä–≥–∏—è": 20
                },
                # ==== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø –î–õ–Ø BOT.PY ====
                "—É—Ö–æ–¥": {  # –î–ª—è –æ–±—â–µ–≥–æ —É—Ö–æ–¥–∞
                    "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 25,
                    "—á–∏—Å—Ç–æ—Ç–∞": 30,
                    "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15,
                    "–∑–¥–æ—Ä–æ–≤—å–µ": 3
                }
            }
            
            # –ù–ê–í–´–ö–ò, –ö–û–¢–û–†–´–ï –£–õ–£–ß–®–ê–Æ–¢–°–Ø –ü–†–ò –î–ï–ô–°–¢–í–ò–Ø–•
            skill_improvements = {
                "–∫–æ—Ñ–µ": ["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ"],
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": ["–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ"],
                "–æ–±–Ω–∏–º–∞—à–∫–∏": ["—Å–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"],
                "—Ä–∞—Å—á–µ—Å—ã–≤–∞–Ω–∏–µ": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—Å–æ–Ω": ["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"],
                "–∏–≥—Ä–∞": ["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"],
                "–∫–æ—Ñ–µ_–∞—Ä—Ç": ["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ", "–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_–±–∞–∑–æ–≤—ã–π": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_—Ä–∞—Å—á–µ—Å–∫–∞": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"],
                "—É—Ö–æ–¥_—à–∞–º–ø—É–Ω—å": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"],
                "—É—Ö–æ–¥": ["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"]
            }
            
            # –ü–†–ò–ú–ï–ù–Ø–ï–ú –ë–ê–ó–û–í–´–ï –≠–§–§–ï–ö–¢–´
            if action_type in base_effects:
                for stat, change in base_effects[action_type].items():
                    if stat in self.stats:
                        old_value = self.stats[stat]
                        if stat == "—Å–æ–Ω" or stat == "–∞–ø–ø–µ—Ç–∏—Ç":
                            # –°–æ–Ω –∏ –∞–ø–ø–µ—Ç–∏—Ç —É–º–µ–Ω—å—à–∞—é—Ç—Å—è –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö
                            self.stats[stat] = max(0, old_value + change)
                        else:
                            # –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è
                            self.stats[stat] = min(100, old_value + change)
                        result["stat_changes"][stat] = self.stats[stat] - old_value
                
                # –£–õ–£–ß–®–ê–ï–ú –ù–ê–í–´–ö–ò
                if action_type in skill_improvements:
                    for skill in skill_improvements[action_type]:
                        if skill in self.skills:
                            improvement = random.randint(1, 3)
                            old_skill = self.skills[skill]
                            self.skills[skill] = min(100, old_skill + improvement)
                            result["skill_changes"][skill] = self.skills[skill] - old_skill
                
                # –î–ê–ï–ú –û–ü–´–¢ –ò –ó–û–õ–û–¢–û
                exp_gained = random.randint(10, 25)
                gold_gained = random.randint(5, 15)
                
                levels = self.add_experience(exp_gained)
                self.gold += gold_gained
                
                result["gold_earned"] = gold_gained
                
                if levels > 0:
                    result["level_up"] = True
                    result["message"] = f"üéâ {self.name} –¥–æ—Å—Ç–∏–≥ {self.level} —É—Ä–æ–≤–Ω—è!"
                
                # –ü–†–û–í–ï–†–Ø–ï–ú –õ–Æ–ë–ò–ú–´–ï –í–ï–©–ò
                if action_data.get("item_type") == self.favorites.get("—Å–ª–∞–¥–æ—Å—Ç—å"):
                    result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + 20
                    result["special_effect"] = "favorite"
                    if result["message"]:
                        result["message"] += f"\nüéâ {self.name} –æ–±–æ–∂–∞–µ—Ç {action_data['item_type']}! +20 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é!"
                    else:
                        result["message"] = f"üéâ {self.name} –æ–±–æ–∂–∞–µ—Ç {action_data['item_type']}! +20 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é!"
                
                # –•–ê–†–ê–ö–¢–ï–†–ù–´–ï –ë–û–ù–£–°–´
                main_trait = self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "")
                character_bonuses = {
                    "–∫–æ—Ñ–µ–º–∞–Ω": {"action": "–∫–æ—Ñ–µ", "bonus": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 15, "–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ": 5}},
                    "–Ω–µ–∂–µ–Ω–∫–∞": {"action": "–æ–±–Ω–∏–º–∞—à–∫–∏", "bonus": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, "—Å–æ–Ω": -10}},
                    "–∏–≥—Ä–∏–∫": {"action": "–∏–≥—Ä–∞", "bonus": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, "–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è": 5}},
                    "–∫–Ω–∏–≥–æ—á–µ–π": {"action": "—Å–æ–Ω", "bonus": {"–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç": 5, "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π_–≤–∫—É—Å": 5}},
                    "—á–∏—Å—Ç—é–ª—è": {"action": "—É—Ö–æ–¥", "bonus": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 25, "–ø—É—à–∏—Å—Ç–æ—Å—Ç—å": 15}},
                    "–≥—É—Ä–º–∞–Ω": {"action": "–∫–æ—Ä–º–ª–µ–Ω–∏–µ", "bonus": {"–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ": 20, "–∫—É–ª–∏–Ω–∞—Ä–Ω–æ–µ_–∏—Å–∫—É—Å—Å—Ç–≤–æ": 5}},
                    "—Å–æ–Ω—è": {"action": "—Å–æ–Ω", "bonus": {"—Å–æ–Ω": -20, "—ç–Ω–µ—Ä–≥–∏—è": 30}},
                    "—ç–Ω–µ—Ä–¥–∂–∞–π–∑–µ—Ä": {"action": "–∏–≥—Ä–∞", "bonus": {"—ç–Ω–µ—Ä–≥–∏—è": -10, "–∞—Ç–ª–µ—Ç–∏—á–Ω–æ—Å—Ç—å": 5}}
                }
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–æ–Ω—É—Å—ã –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞
                for trait, bonus_info in character_bonuses.items():
                    if main_trait == trait and bonus_info["action"] in action_type:
                        for stat, bonus in bonus_info["bonus"].items():
                            if stat in self.stats:
                                self.stats[stat] = min(100, max(0, self.stats[stat] + bonus))
                                result["stat_changes"][stat] = result["stat_changes"].get(stat, 0) + bonus
                            elif stat in self.skills:
                                self.skills[stat] = min(100, self.skills[stat] + bonus)
                                result["skill_changes"][stat] = result["skill_changes"].get(stat, 0) + bonus
                        
                        trait_name = main_trait.capitalize()
                        if result["message"]:
                            result["message"] += f"\n‚ú® {trait_name} –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å!"
                        else:
                            result["message"] = f"‚ú® {trait_name} –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å!"
                        break
                
                # –û–ë–ù–û–í–õ–Ø–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –î–ï–ô–°–¢–í–ò–ô
                if action_type == "–∫–æ—Ñ–µ":
                    self.action_stats["total_coffees"] += 1
                elif action_type == "–∫–æ—Ä–º–ª–µ–Ω–∏–µ":
                    self.action_stats["total_feeds"] += 1
                elif action_type == "–æ–±–Ω–∏–º–∞—à–∫–∏":
                    self.action_stats["total_hugs"] += 1
                elif action_type == "–∏–≥—Ä–∞":
                    self.action_stats["total_games"] += 1
                elif "—É—Ö–æ–¥" in action_type:
                    self.action_stats["total_care"] += 1
                elif action_type == "—Å–æ–Ω":
                    self.action_stats["total_sleep"] += 1
                
                # –ó–ê–ü–ò–°–´–í–ê–ï–ú –ü–û–°–õ–ï–î–ù–ï–ï –î–ï–ô–°–¢–í–ò–ï
                self.last_actions[action_type] = datetime.now().isoformat()
                
            else:
                result["success"] = False
                result["message"] = f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: {action_type}"
                
        except Exception as e:
            result["success"] = False
            result["message"] = f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è: {str(e)}"
            print(f"–û—à–∏–±–∫–∞ –≤ apply_action: {e}")
        
        return result
    
    def apply_minigame_result(self, game_type: str, won: bool, score: int = 0) -> Dict:
        """–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∏–Ω–∏-–∏–≥—Ä—ã"""
        result = {
            "success": True,
            "message": "",
            "stat_changes": {},
            "gold_earned": 0,
            "skill_changes": {}
        }
        
        try:
            # –ë–ê–ó–û–í–´–ï –ù–ê–ì–†–ê–î–´ –ó–ê –ò–ì–†–´
            if won:
                gold = random.randint(10, 30)
                mood_bonus = random.randint(15, 30)
                experience = random.randint(15, 25)
                
                self.gold += gold
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_bonus)
                
                result["gold_earned"] = gold
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = mood_bonus
                
                self.action_stats["total_minigames_won"] += 1
                
                # –£–ª—É—á—à–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏
                self.skills["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] = min(100, self.skills["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] + 3)
                result["skill_changes"]["–∏–≥—Ä–æ–≤–∞—è_—ç—Ä—É–¥–∏—Ü–∏—è"] = 3
                
                # –û—Å–æ–±—ã–µ –±–æ–Ω—É—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä
                if game_type == "coffee_art":
                    self.skills["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ"] = min(100, self.skills["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ"] + 5)
                    self.skills["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"] = min(100, self.skills["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"] + 3)
                    result["skill_changes"]["–∫–æ—Ñ–µ–π–Ω–æ–µ_–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ"] = 5
                    result["skill_changes"]["–∞—Ä—Ç–∏—Å—Ç–∏–∑–º"] = 3
                    result["message"] = "üé® –ü—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –∫–æ—Ñ–µ–π–Ω—ã–π –∞—Ä—Ç! –ù–∞–≤—ã–∫–∏ —É–ª—É—á—à–µ–Ω—ã!"
                elif game_type == "memory":
                    self.skills["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"] = min(100, self.skills["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"] + 4)
                    result["skill_changes"]["–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç"] = 4
                    result["message"] = "üß† –û—Ç–ª–∏—á–Ω–∞—è –ø–∞–º—è—Ç—å! –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç —É–ª—É—á—à–µ–Ω!"
                
                # –î–∞–µ–º –æ–ø—ã—Ç
                self.add_experience(experience)
                
            else:
                mood_penalty = random.randint(-20, -5)
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = max(0, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + mood_penalty)
                
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = mood_penalty
                self.action_stats["total_minigames_lost"] += 1
                
                # –î–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ –¥–∞–∂–µ –∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
                self.add_experience(random.randint(5, 10))
                
                result["message"] = "üòî –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–≤–µ–∑—ë—Ç –±–æ–ª—å—à–µ!"
            
            # –ë–æ–Ω—É—Å –¥–ª—è –∏–≥—Ä–∏–∫–∞
            if self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞") == "–∏–≥—Ä–∏–∫":
                bonus = 15 if won else -5
                self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = min(100, max(0, self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] + bonus))
                result["stat_changes"]["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] = result["stat_changes"].get("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", 0) + bonus
                
                if won:
                    result["message"] += "\nüéÆ –ò–≥—Ä–∏–∫ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç –ø–æ–±–µ–¥—ã!"
                else:
                    result["message"] += "\nüéÆ –ò–≥—Ä–∏–∫ –Ω–µ–º–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω –ø–æ—Ä–∞–∂–µ–Ω–∏–µ–º..."
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–≥—Ä—ã
            self.last_actions["game"] = datetime.now().isoformat()
            
        except Exception as e:
            result["success"] = False
            result["message"] = f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã: {str(e)}"
            print(f"–û—à–∏–±–∫–∞ –≤ apply_minigame_result: {e}")
        
        return result
    
    def can_perform_action(self, action_type: str) -> tuple[bool, str]:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ"""
        try:
            # –ü–†–û–í–ï–†–ö–ò –î–õ–Ø –†–ê–ó–ù–´–• –î–ï–ô–°–¢–í–ò–ô
            checks = {
                "–∫–æ—Ñ–µ": lambda: (
                    self.stats["–∫–æ—Ñ–µ"] < 95,
                    f"‚òï {self.name} —É–∂–µ –ø–æ–ª–æ–Ω –∫–æ—Ñ–µ! –ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ."
                ),
                "–∫–æ—Ä–º–ª–µ–Ω–∏–µ": lambda: (
                    self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 5,
                    f"üç™ {self.name} —Å–ª–∏—à–∫–æ–º —Å—ã—Ç! –ü–æ–¥–æ–∂–¥–∏, –ø–æ–∫–∞ –ø—Ä–æ–≥–æ–ª–æ–¥–∞–µ—Ç—Å—è."
                ),
                "–æ–±–Ω–∏–º–∞—à–∫–∏": lambda: (
                    self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 95,
                    f"ü§ó {self.name} —É–∂–µ –Ω–∞ —Å–µ–¥—å–º–æ–º –Ω–µ–±–µ –æ—Ç —Å—á–∞—Å—Ç—å—è!"
                ),
                "—É—Ö–æ–¥": lambda: (
                    self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 95 or self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 95,
                    f"‚ú® {self.name} —É–∂–µ –∏–¥–µ–∞–ª—å–Ω–æ —É—Ö–æ–∂–µ–Ω!"
                ),
                "—Å–æ–Ω": lambda: (
                    self.stats["—Å–æ–Ω"] > 5,
                    f"üò¥ {self.name} —Å–æ–≤—Å–µ–º –Ω–µ —Ö–æ—á–µ—Ç —Å–ø–∞—Ç—å!"
                ),
                "–∏–≥—Ä–∞": lambda: (
                    self.stats["—ç–Ω–µ—Ä–≥–∏—è"] > 20,
                    f"‚ö° {self.name} —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª –¥–ª—è –∏–≥—Ä!"
                )
            }
            
            if action_type in checks:
                can_perform, message = checks[action_type]()
                return can_perform, message
            
            # –î–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Ä–∞–∑—Ä–µ—à–∞–µ–º
            return True, ""
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ can_perform_action: {e}")
            return True, ""  # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —Ä–∞–∑—Ä–µ—à–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
    
    def get_status_summary(self) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–¥–∫—É —Å—Ç–∞—Ç—É—Å–∞ –¥—Ä–∞–∫–æ–Ω–∞"""
        self.update_over_time()
        
        return {
            "name": self.name,
            "level": self.level,
            "character": self.character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞"),
            "stats": self.stats.copy(),
            "skills": {k: v for k, v in self.skills.items() if v > 0},
            "gold": self.gold,
            "experience": f"{self.experience}/100",
            "favorites": self.favorites,
            "achievements_count": len(self.achievements),
            "total_actions": sum(self.action_stats.values()),
            "needs_attention": self._get_needs_attention()
        }
    
    def _get_needs_attention(self) -> List[str]:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –¥—Ä–∞–∫–æ–Ω—É"""
        needs = []
        
        if self.stats["–∫–æ—Ñ–µ"] < 30:
            needs.append("‚òï –ö–æ—Ñ–µ")
        if self.stats["—Å–æ–Ω"] > 70:
            needs.append("üò¥ –°–æ–Ω")
        if self.stats["–∞–ø–ø–µ—Ç–∏—Ç"] > 70:
            needs.append("üç™ –ï–¥–∞")
        if self.stats["–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"] < 40:
            needs.append("üòä –í–Ω–∏–º–∞–Ω–∏–µ")
        if self.stats["—ç–Ω–µ—Ä–≥–∏—è"] < 30:
            needs.append("‚ö° –û—Ç–¥—ã—Ö")
        if self.stats["–ø—É—à–∏—Å—Ç–æ—Å—Ç—å"] < 50:
            needs.append("‚ú® –£—Ö–æ–¥")
        if self.stats["—á–∏—Å—Ç–æ—Ç–∞"] < 50:
            needs.append("üõÅ –ß–∏—Å—Ç–æ—Ç–∞")
        if self.stats["–∑–¥–æ—Ä–æ–≤—å–µ"] < 70:
            needs.append("‚ù§Ô∏è –ó–∞–±–æ—Ç–∞")
        
        return needs
    
    def to_dict(self) -> Dict:
        """–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç –≤ —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"""
        return {
            "name": self.name,
            "created_at": self.created_at,
            "stats": self.stats,
            "character": self.character,
            "skills": self.skills,
            "level": self.level,
            "experience": self.experience,
            "gold": self.gold,
            "inventory": self.inventory,
            "habits": self.habits,
            "favorites": self.favorites,
            "action_stats": self.action_stats,
            "achievements": self.achievements,
            "last_actions": self.last_actions,
            "special_effects": self.special_effects,
            "last_update": self.last_update
        }
    
    @classmethod
    def from_dict(cls, data: Dict) -> 'Dragon':
        """–°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∏–∑ —Å–ª–æ–≤–∞—Ä—è"""
        try:
            dragon = cls(data.get("name", "–î—Ä–∞–∫–æ—à–∞"))
            dragon.created_at = data.get("created_at", datetime.now().isoformat())
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
            dragon.stats = data.get("stats", dragon.stats.copy())
            
            # –•–∞—Ä–∞–∫—Ç–µ—Ä —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
            character = data.get("character", {})
            if not isinstance(character, dict):
                character = {}
            if "–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞" not in character:
                character["–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞"] = "–Ω–µ–∂–µ–Ω–∫–∞"
            if "–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ" not in character:
                character["–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ"] = []
            if "–æ–ø–∏—Å–∞–Ω–∏–µ" not in character:
                character["–æ–ø–∏—Å–∞–Ω–∏–µ"] = dragon._get_trait_description(character.get("–æ—Å–Ω–æ–≤–Ω–∞—è_—á–µ—Ä—Ç–∞", "–Ω–µ–∂–µ–Ω–∫–∞"))
            dragon.character = character
            
            # –ù–∞–≤—ã–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
            dragon.skills = data.get("skills", dragon.skills.copy())
            
            # –ü—Ä–æ–≥—Ä–µ—Å—Å
            dragon.level = data.get("level", 1)
            dragon.experience = data.get("experience", 0)
            dragon.gold = data.get("gold", 50)
            
            # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ –ø—Ä–∏–≤—ã—á–∫–∏
            dragon.inventory = data.get("inventory", {})
            dragon.habits = data.get("habits", [])
            
            # –õ—é–±–∏–º—ã–µ –≤–µ—â–∏
            dragon.favorites = data.get("favorites", dragon._generate_favorites())
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
            dragon.action_stats = data.get("action_stats", dragon.action_stats.copy())
            
            # –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            dragon.achievements = data.get("achievements", [])
            
            # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
            dragon.last_actions = data.get("last_actions", dragon.last_actions.copy())
            
            # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            dragon.special_effects = data.get("special_effects", dragon.special_effects.copy())
            
            # –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            dragon.last_update = data.get("last_update", datetime.now().isoformat())
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            dragon.update_over_time()
            
            return dragon
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥—Ä–∞–∫–æ–Ω–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è: {e}")
            return cls(data.get("name", "–î—Ä–∞–∫–æ—à–∞") if isinstance(data, dict) else "–î—Ä–∞–∫–æ—à–∞")